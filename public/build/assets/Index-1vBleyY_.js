import{p as k,Q as I,o as i,c as $,w as A,a as o,d as l,g as m,n as C,t as d,F as h,u as f,q as r,k as w,s as E,f as D,e as P}from"./app-lo3yCkmC.js";import{_ as R}from"./AppLayout-De7LQLNn.js";import{a as j,s as p}from"./network-Cfl5nQUc.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TopSnackbar-B1OIxORe.js";const S={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 py-2"},T={class:"flex justify-between items-center"},q={role:"tablist",class:"tabs tabs-boxed tabls-sm justify-self-start min-w-96"},G=["onClick"],L=o("div",{class:""},[o("a",{class:"link link-secondary no-underline stat-title font-bold",href:"https://fluxsd.com/docs",target:"_blank"},"帮助")],-1),z={key:0,class:"grid grid-cols-2"},F={class:"collapse-title text-xl font-medium flex justify-between"},M={class:"flex gap-1 items-center"},W=["onClick"],H=["onClick"],J=["onClick"],Q={class:"p-2"},X={class:"join join-vertical lg:join-horizontal py-1 items-center w-full"},Y={class:"btn join-item w-28 bg-base-300 mr-1"},Z={key:0},K={key:0,class:"badge badge-success text-white font-bold h-8"},tt={key:1,class:"badge badge-neutral"},et={key:1,class:"text-sm p-1"},st={key:2,class:"text-sm p-1"},ot=["href"],at=["name","onUpdate:modelValue"],nt=o("hr",null,null,-1),it={key:0,class:"form-control"},lt={class:"label"},ct={class:"label-text"},rt=o("span",{class:"label-text-alt"},"config/mk_config.ini",-1),dt={class:"label"},_t={class:"label-text-alt"},ft={key:1},bt={class:"stat text-sm font-semibold text-red-500"},vt={__name:"Index",props:["ai_config","config_options","clientConfig"],setup(y){const g=y,u=k(g.ai_config),V=I(),t=k({configOption:"engine"});Object.entries(u).forEach(([a,_])=>{Object.entries(_).forEach(([s,e])=>{Object.entries(e).forEach(([n,c])=>{if(n!="label"){let b=a+"."+s+"."+n;t[b]=c}})})});function B(a){t.configOption=a}async function N(a,_){console.log(a,_,t);let s={pkey:a,skey:_,config:JSON.stringify(t)},e=await j("post","/api/config/update",s);if(console.log(e),e!=null&&e.code==1)p(r("Operation successfully"),"success");else{p(e.msg??r("Operation failed"),"error");return}}async function v(a,_){let s=a+"."+_+".is_active";if(t[s]=t[s]==1?0:1,a=="storage")if(t[s]==1)Object.entries(u[a]).forEach(([c,b])=>{console.log(b),u[a][c].is_active=0;let x=a+"."+c+".is_active";t[x]=0}),t[s]=1;else{let c=!1;if(Object.entries(u[a]).forEach(([b,x])=>{let O=a+"."+b+".is_active";if(console.log(t[O]),t[O]==1){c=!0;return}}),!c){p(r("At least one active storage is required"),"info"),t[s]=1;return}}let e={c_key:s,c_value:t[s]},n=await j("post","/api/config/active",e);if(n!=null&&n.code==1)u[a][_].is_active=t[s];else{p(n.msg??r("Operation failed"),"error");return}console.log(n)}function U(){var a=document.createElement("canvas"),_=a.getContext("webgl")||a.getContext("experimental-webgl"),s=_.getExtension("WEBGL_debug_renderer_info"),e=s?_.getParameter(s.UNMASKED_RENDERER_WEBGL):"Unavailable";return e}return U(),(a,_)=>(i(),$(R,{title:"Config Panel"},{default:A(()=>[o("div",S,[o("div",T,[o("div",q,[(i(!0),l(h,null,m(g.config_options,(s,e)=>(i(),l("a",{key:e,class:C([{"tab-active":s.option==t.configOption},"tab"]),onClick:n=>B(s.option),role:"tab"},d(s.label),11,G))),128))]),L]),f(V).props.auth.user.is_admin==1?(i(),l("div",z,[(i(!0),l(h,null,m(u[t.configOption],(s,e)=>(i(),l("div",{key:"e_"+e,class:"m-2"},[o("div",{class:C(["rounded-xl h-full",s.is_active==1?"bg-base-200 border border-green-600":"bg-base-200"])},[o("div",F,[o("div",null,d(f(r)(e)),1),o("div",M,[s.is_active==0?(i(),l("button",{key:0,class:"btn btn-primary btn-sm",onClick:n=>v(t.configOption,e)},d(f(r)("active")),9,W)):(i(),l("button",{key:1,class:"btn btn-neutral btn-sm",onClick:n=>v(t.configOption,e)},d(f(r)("disable")),9,H)),o("button",{class:"btn btn-primary btn-sm",onClick:n=>N(t.configOption,e)},d(f(r)("save")),9,J)])]),o("div",Q,[(i(!0),l(h,null,m(s,(n,c)=>(i(),l("div",{key:e+c},[o("div",X,[o("label",Y,d(f(r)(c)),1),c=="is_active"?(i(),l("div",Z,[n=="1"?(i(),l("div",K,d(f(r)("actived")),1)):(i(),l("div",tt,d(f(r)("disabled")),1))])):c=="label"?(i(),l("label",et,d(f(r)(n)),1)):c=="apply_url"?(i(),l("label",st,[o("a",{href:n,target:"_blank"},d(n),9,ot)])):w((i(),l("input",{key:3,type:"text",placeholder:"Type here",name:t.configOption+"."+e+"."+c,class:"join-item input input-bordered w-full max-w-xs","onUpdate:modelValue":b=>t[t.configOption+"."+e+"."+c]=b},null,8,at)),[[E,t[t.configOption+"."+e+"."+c]]])])]))),128)),nt,t.configOption=="engine"&&e=="lc"?(i(),l("label",it,[o("div",lt,[o("span",ct,d(f(r)("Image generator config file")),1),rt]),w(o("textarea",{class:"textarea textarea-bordered h-24",placeholder:"","onUpdate:modelValue":_[0]||(_[0]=n=>g.clientConfig=n)},`
                            `,512),[[E,g.clientConfig]]),o("div",dt,[o("span",_t,d(f(r)("Paste this content into the file:config/mk_config.ini")),1),D(" "+d(e),1)])])):P("",!0)])],2)]))),128))])):(i(),l("div",ft,[o("p",bt,d(f(r)("Only administrators can manage configuration")),1)]))])]),_:1}))}};export{vt as default};

import{r as q,y as we,o as P,d as A,a as u,t as B,F as le,g as ce,p as Fe,j as Ht,n as Ie,Q as Kt,k as ne,z as ae,u as z,q as O,b as W,f as Yt,A as ns,e as pe,B as is,C as ss,c as Ce,w as qt,s as Bt,O as rs}from"./app-lo3yCkmC.js";import{_ as os}from"./AppLayout-De7LQLNn.js";import{a as ct,s as Oe,g as as,c as ls,b as cs,e as us}from"./network-Cfl5nQUc.js";import{_ as Ue}from"./TSSwitch-LhUy5i3o.js";import{_ as ye}from"./TSSlider-DDzjoIvW.js";import hs from"./ImageNav-Cr3uulRl.js";import{_ as ds}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TopSnackbar-B1OIxORe.js";const fs={class:"join py-4"},ps={class:"font-semibold grid join-item btn items-center justify-items-center text-center"},vs={class:"relative join-item"},gs={class:"h-12 bg-white flex border border-gray-200 rounded items-center"},ms=["value"],bs=u("svg",{class:"w-4 h-4 mx-2 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[u("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),u("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),_s=[bs],ys=["for"],ws=u("svg",{class:"w-4 h-4 mx-2 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[u("polyline",{points:"18 15 12 9 6 15"})],-1),ks=[ws],xs=["id","checked"],Cs={class:"absolute rounded shadow bg-white overflow-hidden hidden peer-checked:flex flex-col w-full mt-1 border border-gray-200 z-10"},Ss=["onClick"],Ts={class:"block p-2 border-transparent border-l-4 group-hover:border-blue-600 group-hover:bg-gray-100"},Ps={__name:"TSSelector",props:["name","init","label","def"],emits:["tsComCallback"],setup(p,{emit:d}){const r=p,a=d,o=q(!1),l=q({name:r.name,val:r.def??""});r.init!=null&&r.init.length>0&&(l.value=r.init[0]);function c(v){try{a("tsComCallback",r.name,v),o.value=!1,l.value=v}catch(w){console.log(w)}}function m(){a("tsComCallback",r.name,""),o.value=!0,l.value={name:r.name,val:""}}return we(()=>r.def,v=>{l.value.val=r.def}),(v,w)=>(P(),A("div",fs,[u("label",ps,B(r.label),1),u("div",vs,[u("div",gs,[u("input",{onClick:w[0]||(w[0]=y=>o.value=!o.value),value:l.value.val,name:"select",id:"select",class:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 peer-focus:text-primary data-[twe-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none [&:not([data-twe-input-placeholder-active])]:placeholder:opacity-0",checked:""},null,8,ms),u("button",{onClick:m,class:"cursor-pointer outline-none focus:outline-none transition-all text-gray-300 hover:text-gray-600"},_s),u("label",{for:"show_more"+r.name,class:"cursor-pointer outline-none focus:outline-none border-l border-gray-200 transition-all text-gray-300 hover:text-gray-600"},ks,8,ys)]),u("input",{type:"checkbox",name:"show_morew",id:"show_more"+r.name,class:"hidden peer",checked:o.value},null,8,xs),u("div",Cs,[(P(!0),A(le,null,ce(r.init,(y,C)=>(P(),A("div",{key:C+"_Sel",class:"cursor-pointer group border-t",onClick:T=>c(y)},[u("a",Ts,B(y.label),1)],8,Ss))),128))])])]))}},js={key:0,class:"inline-flex rounded-md shadow-sm overflow-clip",role:"group"},Os=u("svg",{class:"w-[20px] h-[20px] fill-[#8e8e8e]",viewBox:"0 0 320 512",xmlns:"http://www.w3.org/2000/svg"},[u("path",{d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"})],-1),Is=[Os],Ls=["onClick"],As=u("svg",{class:"w-[20px] h-[20px] fill-[#8e8e8e]",viewBox:"0 0 320 512",xmlns:"http://www.w3.org/2000/svg"},[u("path",{d:"M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"})],-1),Es=[As],Rs={key:1},Ft=7,$s={__name:"Paginate",props:["total","cpage"],emits:["handleJump"],setup(p,{emit:d}){const r=d,a=p;var o=0,l=0;Fe({start:0,end:0});const c=Ht(()=>{let w=[];o=a.cpage-Math.floor(Ft/2),o=o<1?1:o,l=o+Ft,l=l>a.total?a.total:l;for(let y=o;y<=l;y++){let C={label:y,page:y};w.push(C)}return w}),m=Ht(()=>w=>({"bg-slate-300 hover:bg-slate-500 focus:bg-slate-300 ":a.cpage==w,"bg-neutral-100 hover:bg-slate-500":a.cpage!=w}));function v(w){w>a.total||w<1||r("handleJump",w)}return(w,y)=>p.total>1?(P(),A("div",js,[u("button",{type:"button",class:"bg-neutral-100 rounded-l hover:bg-slate-500 inline-block px-3 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal text-neutral-800 transition duration-150 ease-in-out focus:ring-0 active:bg-neutral-200","data-te-ripple-init":"","data-te-ripple-color":"light",onClick:y[0]||(y[0]=C=>v(parseInt(a.cpage)-1))},Is),(P(!0),A(le,null,ce(c.value,(C,T)=>(P(),A("button",{type:"button",class:Ie(["inline-block px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal text-neutral-800 transition duration-150 ease-in-out focus:ring-0 active:bg-neutral-200",m.value(C.page)]),"data-te-ripple-init":"","data-te-ripple-color":"light",onClick:R=>v(C.page),key:T},B(C.label),11,Ls))),128)),u("button",{type:"button",class:"bg-neutral-100 rounded-r hover:bg-slate-500 inline-block px-3 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal text-neutral-800 transition duration-150 ease-in-out focus:ring-0 active:bg-neutral-200","data-te-ripple-init":"","data-te-ripple-color":"light",onClick:y[1]||(y[1]=C=>v(parseInt(a.cpage)+1))},Es)])):(P(),A("div",Rs))}},Ns={class:"join py-4"},zs={class:"font-semibold grid join-item btn items-center justify-items-center text-center"},Ds={class:"relative join-item"},Ms={class:"h-12 bg-white flex border border-gray-200 rounded items-center"},Us=["src"],Hs=["value"],qs=u("svg",{class:"w-4 h-4 mx-2 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[u("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),u("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),Bs=[qs],Fs=["for"],Xs=u("svg",{class:"w-4 h-4 mx-2 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[u("polyline",{points:"18 15 12 9 6 15"})],-1),Js=[Xs],Ws=["id","checked"],Vs={class:"absolute size-[48rem] rounded shadow bg-white overflow-hidden hidden peer-checked:flex flex-col mt-1 border border-gray-200 z-20"},Gs={class:"flex justify-end pt-2 pr-4 gap-x-2 items-center"},Qs={class:"text-xs",href:"/models",target:"_blank"},Ks={class:"p-2 flex justify-between h-16"},Ys={class:"menu lg:menu-horizontal z-30 w-40 justify-end"},Zs={close:""},er={class:"w-40 justify-end"},tr=["onClick"],nr={key:0,class:"w-5 h-5 fill-[#0eaf19]",viewBox:"0 0 448 512",xmlns:"http://www.w3.org/2000/svg"},ir=u("path",{d:"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"},null,-1),sr=[ir],rr={key:1,class:"w-5"},or={class:"overscroll-auto overflow-auto"},ar={class:"w-full grid grid-cols-3 lg:grid-cols-4 gap-2 px-2"},lr=["onClick"],cr={class:"absolute z-20 inset-0 bg-gray-900 opacity-0 transition-opacity duration-300 hover:opacity-80 flex items-center justify-center text-white whitespace-pre-wrap overflow-wrap-break-word break-all p-2"},ur={class:"absolute inset-0"},hr=["src"],dr={class:"p-2 flex justify-center"},Xt={__name:"TSSelectorModel",props:["name","init","label","def","engine","base"],emits:["tsComCallback"],setup(p,{emit:d}){Kt();const r=p,a=d,o=q(!1),l=q({name:r.name,val:r.def??"",thumb:null}),c=q(1),m=q([]),v=q(0);var w=["1.5","pre1.5","sdxl","presdxl","presd3"];const y=Fe(w);function C(f){let _=y.indexOf(f);_!==-1?y.splice(_,1):y.push(f),T(1,r.init),console.log(y)}T(1,r.init),we(()=>r.engine,f=>{r.def==null&&(l.value={name:r.name,val:r.def??"",thumb:null}),T(1,r.init),c.value=1}),we(()=>r.base,f=>{y.splice(0,y.length),w=[],r.base=="1.5"?(y.push("1.5","pre1.5"),w.push("1.5","pre1.5")):(y.push("sdxl","presdxl","presd3"),w.push("sdxl","presdxl","presd3")),T(1,r.init)}),we(()=>r.def,f=>{l.value.val=r.def});async function T(f,_){let k=await ct("get","/api/models",{page:f,engine:r.engine,types:JSON.stringify([_]),options:JSON.stringify(y),service:1});k.code==1&&(m.value=k.data,v.value=k.meta.last_page,w=k.base_models)}function R(f){c.value=f,T(f,r.init)}function N(f){if(r.engine=="lc"&&f.is_download!=1){Oe("You must download this model before using it","error");return}try{o.value=!1,l.value.val=f.sd_name,l.value.thumb=f.thumb,a("tsComCallback",r.name,f)}catch(_){console.log(_)}}function S(){a("tsComCallback",r.name,""),o.value=!0,l.value={name:r.name,val:""}}return(f,_)=>(P(),A("div",Ns,[u("label",zs,B(r.label),1),u("div",Ds,[u("div",Ms,[ne(u("img",{class:"object-cover w-12 h-12 pr-1",src:l.value.thumb},null,8,Us),[[ae,l.value.thumb!=null]]),u("input",{onClick:_[0]||(_[0]=k=>o.value=!o.value),value:l.value.val,name:"select",id:"select",class:"peer block min-h-[auto] w-full rounded border-0 bg-transparent px-3 py-[0.32rem] leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 peer-focus:text-primary data-[twe-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none [&:not([data-twe-input-placeholder-active])]:placeholder:opacity-0",checked:""},null,8,Hs),u("button",{onClick:S,class:"cursor-pointer outline-none focus:outline-none transition-all text-gray-300 hover:text-gray-600"},Bs),u("label",{for:"show_more"+r.name,class:"cursor-pointer outline-none focus:outline-none border-l border-gray-200 transition-all text-gray-300 hover:text-gray-600"},Js,8,Fs)]),u("input",{type:"checkbox",name:"show_morew",id:"show_more"+r.name,class:"hidden peer",checked:o.value},null,8,Ws),u("div",Vs,[u("div",Gs,[u("a",Qs,B(z(O)("market"))+">>",1),u("button",{class:"btn btn-outline btn-sm",onClick:_[1]||(_[1]=k=>o.value=!1)},B(z(O)("close")),1)]),u("div",Ks,[W($s,{total:v.value,cpage:c.value,onHandleJump:R},null,8,["total","cpage"]),u("ul",Ys,[u("li",null,[u("details",Zs,[u("summary",er,B(z(O)("filter")),1),u("ul",null,[(P(!0),A(le,null,ce(z(w),(k,$)=>(P(),A("li",{key:"option_"+$},[u("a",{onClick:J=>C(k)},[y.includes(k)?(P(),A("svg",nr,sr)):(P(),A("div",rr)),Yt(" "+B(k),1)],8,tr)]))),128))])])])])]),u("div",or,[u("div",ar,[(P(!0),A(le,null,ce(m.value,(k,$)=>(P(),A("div",{key:"pl_"+$,class:"m-4 relative text-sm font-medium bg-gray-200 hover:bg-gray-300 cursor-pointer"},[u("div",{onClick:J=>N(k),class:"relative h-60"},[u("div",cr,B(k.sd_name)+":"+B(k.base_model),1),u("div",ur,[u("img",{class:"object-cover h-full w-full",src:k.thumb},null,8,hr)])],8,lr),u("div",dr,B(k.name),1)]))),128))])])])])]))}},fr={class:"p-1"},pr=["value","placeholder"],Jt={__name:"TSTextArea",props:["name","init","label","def"],emits:["tsComCallback"],setup(p,{emit:d}){const r=p,a=d,o=q(r.def??""),l=c=>{o.value=c.target.value,a("tsComCallback",r.name,o.value)};return we(()=>r.def,c=>{o.value=r.def}),(c,m)=>(P(),A("div",fr,[u("textarea",{value:o.value,onInput:l,class:"textarea textarea-bordered w-full",placeholder:r.label},`
    `,40,pr)]))}},vr={class:"flex gap-2"},gr=["onClick"],mr={class:"h-14 w-14 text-center place-items-center grid"},br={class:"text-center font-serif text-gray-800"},_r={__name:"TSAspect",props:["name","init","label","def"],emits:["tsComCallback"],setup(p,{emit:d}){const r=p,a=d,o=q(r.def??0);function l(c,m){a("tsComCallback",r.name,m),o.value=m}return(c,m)=>(P(),A("div",vr,[(P(!0),A(le,null,ce(r.init,(v,w)=>(P(),A("div",{onClick:y=>l(v,w),key:w,class:Ie(["bg-gray-300 text-center cursor-pointer",o.value==w?"border-solid border-4 border-green-500":""])},[u("div",mr,[u("div",{class:"bg-white",style:ns({height:v.height/30+"px",width:v.width/30+"px"})},null,4)]),u("div",br,B(v.label),1)],10,gr))),128))]))}},yr={key:0,class:"m-1 h-full w-full relative inline-flex items-center p-3 text-sm font-medium text-center text-white bg-gray-200 rounded-lg hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-700"},wr=["src"],kr=u("svg",{class:"w-[20px] h-[20px] fill-[#dd2222]",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},[u("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM184 232H328c13.3 0 24 10.7 24 24s-10.7 24-24 24H184c-13.3 0-24-10.7-24-24s10.7-24 24-24z"})],-1),xr=[kr],Cr={key:1,for:"dropzone-file",class:"m-1 flex h-full w-full flex-col items-center justify-center border-2 border-gray-400 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-200"},Sr={class:"flex flex-col items-center justify-center p-4"},Tr={class:"mb-4 text-sm text-gray-500"},Pr={class:"font-semibold"},jr=u("p",{class:"text-xs text-gray-500"},"PNG or JPG",-1),Or={__name:"TSUploadImage",props:["name","desc","def"],emits:["tsComCallback"],setup(p,{emit:d}){const r=p,a=q(r.def),o=d;function l(m){m.target.files[0]!==void 0&&(as(m.target.files[0]).then(v=>{a.value=v}).catch(v=>{console.log(v)}),o("tsComCallback",r.name,m.target.files[0]))}function c(){a.value=null,o("tsComCallback",r.name,null)}return we(()=>r.def,m=>{a.value=r.def}),(m,v)=>a.value!=null?(P(),A("div",yr,[u("img",{src:a.value,class:"object-cover w-36 h-36"},null,8,wr),u("button",{type:"button",class:"absolute inline-flex items-center justify-center w-6 h-6 text-xs font-bold text-white border-2 border-white rounded-full -top-2 -right-2 dark:border-gray-900",onClick:v[0]||(v[0]=w=>c(m.index))},xr)])):(P(),A("label",Cr,[u("div",Sr,[u("p",Tr,[u("span",Pr,B(r.desc??""),1)]),u("input",{id:"dropzone-file",type:"file",multiple:"",accept:"image/png, image/jpeg",class:"hidden",onInput:v[1]||(v[1]=w=>l(w))},null,32),jr])]))}},Ir={class:"px-4 py-2 sm:px-6 lg:px-8 lg:py-2 mx-auto flex mb-2 sm:mb-2"},Lr={class:"oneline"},Ar=["width","height"],Er=u("path",{"fill-rule":"evenodd",d:"M9.224 1.553a.5.5 0 0 1 .223.67L6.56 8l2.888 5.776a.5.5 0 1 1-.894.448l-3-6a.5.5 0 0 1 0-.448l3-6a.5.5 0 0 1 .67-.223z"},null,-1),Rr=[Er],$r={id:"style-list",class:"flex flex-nowrap overscroll-auto overflow-auto"},Nr=["onClick"],zr=["src"],Dr={class:"oneline"},Mr=["width","height"],Ur=u("path",{"fill-rule":"evenodd",d:"M6.776 1.553a.5.5 0 0 1 .671.223l3 6a.5.5 0 0 1 0 .448l-3 6a.5.5 0 1 1-.894-.448L9.44 8 6.553 2.224a.5.5 0 0 1 .223-.671z"},null,-1),Hr=[Ur],qr={__name:"TSImageQueue",props:["name","init","def","tabstyle","moveto"],emits:["tsComCallback"],setup(p,{emit:d}){const r=p,a=d,o=q(r.def??0);we(()=>r.moveto,v=>{const w=r.moveto.split("_");console.log(w),w[0]=="next"?m(o.value+1):m(o.value-1)});const l={small:{btnw:30,btnh:70,blockw:"w-16",img:"w-16 h-16 object-cover cursor-pointer",pix:68},normal:{btnw:50,btnh:120,blockw:"w-32",img:"w-32 h-32 object-cover cursor-pointer",pix:132}},c=r.tabstyle=="normal"?l.normal:l.small;async function m(v){let w=parseInt(r.init.length);v=v<0?0:v,v=v>=w?w-1:v;let y=r.init[v];y.index=v,a("tsComCallback",r.name,y),o.value=v;let C=(v-2)*c.pix;document.getElementById("style-list").scrollTo({left:C,behavior:"smooth"})}return(v,w)=>ne((P(),A("div",Ir,[u("div",Lr,[u("button",{class:"movebutton",type:"button",onClick:w[0]||(w[0]=y=>m(o.value-1))},[(P(),A("svg",{width:z(c).btnw,height:z(c).btnh,fill:"currentColor",class:"bi bi-chevron-compact-left",viewBox:"0 0 16 16"},Rr,8,Ar))])]),u("div",$r,[(P(!0),A(le,null,ce(r.init,(y,C)=>(P(),A("div",{class:"text-center m-1",onClick:T=>m(C),key:"L"+C},[u("div",{class:Ie(z(c).blockw)},[u("img",{class:Ie([z(c).img,{"border-solid border-4 border-green-500":C==o.value}]),src:y.thumb},null,10,zr)],2)],8,Nr))),128))]),u("div",Dr,[u("button",{class:"movebutton",type:"button",onClick:w[1]||(w[1]=y=>m(o.value+1))},[(P(),A("svg",{width:z(c).btnw,height:z(c).btnh,fill:"currentColor",class:"bi bi-chevron-compact-right",viewBox:"0 0 16 16"},Hr,8,Mr))])])],512)),[[ae,r.init!=null&&r.init.length>0]])}},Br={class:"py-2 overflow-scroll"},Fr=["onClick"],Xr={__name:"TSStyle",props:["name","init","def"],emits:["tsComCallback"],setup(p,{emit:d}){const r=p,a=d;return(o,l)=>(P(),A("div",Br,[(P(!0),A(le,null,ce(r.init,(c,m)=>(P(),A("button",{onClick:v=>a("tsComCallback",r.name,c),key:m,class:"btn btn-sm bg-slate-100 m-1"},B(c),9,Fr))),128))]))}},Jr=["name","checked","onInput"],Wr={class:"label-text"},Wt={__name:"TSRadio",props:["init","def","name"],emits:["tsComCallback"],setup(p,{emit:d}){const r=p,a=d;function o(l){try{a("tsComCallback",r.name,l.val)}catch(c){console.log(c)}}return(l,c)=>(P(!0),A(le,null,ce(r.init,(m,v)=>(P(),A("label",{key:v,class:"label cursor-pointer gap-1"},[u("input",{type:"radio",name:r.name,class:"radio checked:bg-red-500",checked:r.def==m.val,onInput:w=>o(m)},null,40,Jr),u("span",Wr,B(m.label),1)]))),128))}},Vr={},Gr={id:"snackbar"};function Qr(p,d){return P(),A("div",Gr,"Some text some message..")}const Kr=ds(Vr,[["render",Qr]]),Yr={class:"mt-4"},Zr={class:"flex-row sm:w-11/12 lg:w-3/4 mx-auto text-center grid justify-items-center"},eo={key:0,class:"grid justify-items-center"},to=["onClick","disabled"],no={__name:"OperationButton",props:["init","name","img"],emits:["btnAction"],setup(p,{emit:d}){const r=p,a=d,o=q({act:null,img:null});function l(c){o.value={act:c.act,img:r.img},a("btnAction",o.value)}return(c,m)=>(P(),A("div",Yr,[u("div",Zr,[r.init!=null?(P(),A("div",eo,[(P(!0),A(le,null,ce(r.init,(v,w)=>(P(),A("div",{key:"IB_"+w,class:"items-center inline-flex"},[(P(!0),A(le,null,ce(v,(y,C)=>(P(),A("button",{onClick:T=>l(y),key:"BS_"+C,type:"button",class:Ie([o.value.act==y.act?"bg-red-800 hover:bg-red-900":"bg-gray-600 hover:bg-gray-900","text-white bg-gray-800 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-full text-sm px-5 py-2.5 mr-2 mb-2"]),disabled:o.value.act==y.act},B(y.label),11,to))),128))]))),128))])):pe("",!0)])]))}},so=[],ro=[{label:"Normal",val:"normal"},{label:"Cute",val:"cute"},{label:"Expressive",val:"expressive"},{label:"Original",val:"original"},{label:"Scenic",val:"scenic"}],oo=[{label:"None",val:null},{label:"2X",val:"2x"},{label:"4X",val:"4x"}],fe=Fe({styleList:so,nijiStyle:ro,upscaleOptions:oo,mjConfig:{denoising_strength:{min:"0",max:"2",def:"1",label:O("Denoising strength"),val:1,step:"1"},seed:{min:"0",max:"4294967295",def:"0",label:O("Seed"),val:"0"},cfg_scale:{min:"0",max:"1000",def:"100",label:O("Scale"),val:"100"},steps:{min:"0.25",max:"1",def:"1",label:O("Steps"),val:"1",step:"0.25"},niji:[{key:"normal",val:O("Normal")},{key:"cute",val:O("Cute")},{key:"expressive",val:O("Expressive")},{key:"original",val:O("Original")},{key:"scenic",val:O("Scenic")}],weird:{min:"0",max:"3000",def:"100",label:O("Weird"),val:"0"},sampler:{label:O("Sampler"),val:""},cref:{min:"0",max:"100",def:"0",label:O("cref"),val:"0"},sref:{min:"0",max:"10",def:"0",label:O("sref"),val:"0"}},sdConfig:{denoising_strength:{min:"0",max:"1",def:"0.4",label:O("Denoising strength"),val:"0.4",step:"0.01"},seed:{min:"-1",max:"4294967295",def:"0",label:O("Seed"),val:"0"},cfg_scale:{min:"0",max:"30",def:"7",label:O("Scale"),val:"7"},steps:{min:"0",max:"50",def:"30",label:O("Steps"),val:"30",step:"1"},weird:{min:"0",max:"0",def:"0",label:O("Weird"),val:"0"},sampler:{label:O("Sampler"),val:"K_DPM_2"}}});function He(p){"@babel/helpers - typeof";return He=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},He(p)}function Y(p,d){if(!(p instanceof d))throw new TypeError("Cannot call a class as a function")}function Vt(p,d){for(var r=0;r<d.length;r++){var a=d[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(p,a.key,a)}}function Z(p,d,r){return d&&Vt(p.prototype,d),r&&Vt(p,r),Object.defineProperty(p,"prototype",{writable:!1}),p}function Le(){return Le=Object.assign||function(p){for(var d=1;d<arguments.length;d++){var r=arguments[d];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(p[a]=r[a])}return p},Le.apply(this,arguments)}function ie(p,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function");p.prototype=Object.create(d&&d.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),Object.defineProperty(p,"prototype",{writable:!1}),d&&ut(p,d)}function qe(p){return qe=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},qe(p)}function ut(p,d){return ut=Object.setPrototypeOf||function(a,o){return a.__proto__=o,a},ut(p,d)}function ao(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lo(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}function co(p,d){if(d&&(typeof d=="object"||typeof d=="function"))return d;if(d!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lo(p)}function se(p){var d=ao();return function(){var a=qe(p),o;if(d){var l=qe(this).constructor;o=Reflect.construct(a,arguments,l)}else o=a.apply(this,arguments);return co(this,o)}}var ht=function(){function p(){Y(this,p)}return Z(p,[{key:"listenForWhisper",value:function(r,a){return this.listen(".client-"+r,a)}},{key:"notification",value:function(r){return this.listen(".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",r)}},{key:"stopListeningForWhisper",value:function(r,a){return this.stopListening(".client-"+r,a)}}]),p}(),Zt=function(){function p(d){Y(this,p),this.namespace=d}return Z(p,[{key:"format",value:function(r){return[".","\\"].includes(r.charAt(0))?r.substring(1):(this.namespace&&(r=this.namespace+"."+r),r.replace(/\./g,"\\"))}},{key:"setNamespace",value:function(r){this.namespace=r}}]),p}(),Xe=function(p){ie(r,p);var d=se(r);function r(a,o,l){var c;return Y(this,r),c=d.call(this),c.name=o,c.pusher=a,c.options=l,c.eventFormatter=new Zt(c.options.namespace),c.subscribe(),c}return Z(r,[{key:"subscribe",value:function(){this.subscription=this.pusher.subscribe(this.name)}},{key:"unsubscribe",value:function(){this.pusher.unsubscribe(this.name)}},{key:"listen",value:function(o,l){return this.on(this.eventFormatter.format(o),l),this}},{key:"listenToAll",value:function(o){var l=this;return this.subscription.bind_global(function(c,m){if(!c.startsWith("pusher:")){var v=l.options.namespace.replace(/\./g,"\\"),w=c.startsWith(v)?c.substring(v.length+1):"."+c;o(w,m)}}),this}},{key:"stopListening",value:function(o,l){return l?this.subscription.unbind(this.eventFormatter.format(o),l):this.subscription.unbind(this.eventFormatter.format(o)),this}},{key:"stopListeningToAll",value:function(o){return o?this.subscription.unbind_global(o):this.subscription.unbind_global(),this}},{key:"subscribed",value:function(o){return this.on("pusher:subscription_succeeded",function(){o()}),this}},{key:"error",value:function(o){return this.on("pusher:subscription_error",function(l){o(l)}),this}},{key:"on",value:function(o,l){return this.subscription.bind(o,l),this}}]),r}(ht),uo=function(p){ie(r,p);var d=se(r);function r(){return Y(this,r),d.apply(this,arguments)}return Z(r,[{key:"whisper",value:function(o,l){return this.pusher.channels.channels[this.name].trigger("client-".concat(o),l),this}}]),r}(Xe),ho=function(p){ie(r,p);var d=se(r);function r(){return Y(this,r),d.apply(this,arguments)}return Z(r,[{key:"whisper",value:function(o,l){return this.pusher.channels.channels[this.name].trigger("client-".concat(o),l),this}}]),r}(Xe),fo=function(p){ie(r,p);var d=se(r);function r(){return Y(this,r),d.apply(this,arguments)}return Z(r,[{key:"here",value:function(o){return this.on("pusher:subscription_succeeded",function(l){o(Object.keys(l.members).map(function(c){return l.members[c]}))}),this}},{key:"joining",value:function(o){return this.on("pusher:member_added",function(l){o(l.info)}),this}},{key:"whisper",value:function(o,l){return this.pusher.channels.channels[this.name].trigger("client-".concat(o),l),this}},{key:"leaving",value:function(o){return this.on("pusher:member_removed",function(l){o(l.info)}),this}}]),r}(Xe),en=function(p){ie(r,p);var d=se(r);function r(a,o,l){var c;return Y(this,r),c=d.call(this),c.events={},c.listeners={},c.name=o,c.socket=a,c.options=l,c.eventFormatter=new Zt(c.options.namespace),c.subscribe(),c}return Z(r,[{key:"subscribe",value:function(){this.socket.emit("subscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"unsubscribe",value:function(){this.unbind(),this.socket.emit("unsubscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"listen",value:function(o,l){return this.on(this.eventFormatter.format(o),l),this}},{key:"stopListening",value:function(o,l){return this.unbindEvent(this.eventFormatter.format(o),l),this}},{key:"subscribed",value:function(o){return this.on("connect",function(l){o(l)}),this}},{key:"error",value:function(o){return this}},{key:"on",value:function(o,l){var c=this;return this.listeners[o]=this.listeners[o]||[],this.events[o]||(this.events[o]=function(m,v){c.name===m&&c.listeners[o]&&c.listeners[o].forEach(function(w){return w(v)})},this.socket.on(o,this.events[o])),this.listeners[o].push(l),this}},{key:"unbind",value:function(){var o=this;Object.keys(this.events).forEach(function(l){o.unbindEvent(l)})}},{key:"unbindEvent",value:function(o,l){this.listeners[o]=this.listeners[o]||[],l&&(this.listeners[o]=this.listeners[o].filter(function(c){return c!==l})),(!l||this.listeners[o].length===0)&&(this.events[o]&&(this.socket.removeListener(o,this.events[o]),delete this.events[o]),delete this.listeners[o])}}]),r}(ht),tn=function(p){ie(r,p);var d=se(r);function r(){return Y(this,r),d.apply(this,arguments)}return Z(r,[{key:"whisper",value:function(o,l){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(o),data:l}),this}}]),r}(en),po=function(p){ie(r,p);var d=se(r);function r(){return Y(this,r),d.apply(this,arguments)}return Z(r,[{key:"here",value:function(o){return this.on("presence:subscribed",function(l){o(l.map(function(c){return c.user_info}))}),this}},{key:"joining",value:function(o){return this.on("presence:joining",function(l){return o(l.user_info)}),this}},{key:"whisper",value:function(o,l){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(o),data:l}),this}},{key:"leaving",value:function(o){return this.on("presence:leaving",function(l){return o(l.user_info)}),this}}]),r}(tn),Be=function(p){ie(r,p);var d=se(r);function r(){return Y(this,r),d.apply(this,arguments)}return Z(r,[{key:"subscribe",value:function(){}},{key:"unsubscribe",value:function(){}},{key:"listen",value:function(o,l){return this}},{key:"listenToAll",value:function(o){return this}},{key:"stopListening",value:function(o,l){return this}},{key:"subscribed",value:function(o){return this}},{key:"error",value:function(o){return this}},{key:"on",value:function(o,l){return this}}]),r}(ht),Gt=function(p){ie(r,p);var d=se(r);function r(){return Y(this,r),d.apply(this,arguments)}return Z(r,[{key:"whisper",value:function(o,l){return this}}]),r}(Be),vo=function(p){ie(r,p);var d=se(r);function r(){return Y(this,r),d.apply(this,arguments)}return Z(r,[{key:"here",value:function(o){return this}},{key:"joining",value:function(o){return this}},{key:"whisper",value:function(o,l){return this}},{key:"leaving",value:function(o){return this}}]),r}(Be),dt=function(){function p(d){Y(this,p),this._defaultOptions={auth:{headers:{}},authEndpoint:"/broadcasting/auth",userAuthentication:{endpoint:"/broadcasting/user-auth",headers:{}},broadcaster:"pusher",csrfToken:null,bearerToken:null,host:null,key:null,namespace:"App.Events"},this.setOptions(d),this.connect()}return Z(p,[{key:"setOptions",value:function(r){this.options=Le(this._defaultOptions,r);var a=this.csrfToken();return a&&(this.options.auth.headers["X-CSRF-TOKEN"]=a,this.options.userAuthentication.headers["X-CSRF-TOKEN"]=a),a=this.options.bearerToken,a&&(this.options.auth.headers.Authorization="Bearer "+a,this.options.userAuthentication.headers.Authorization="Bearer "+a),r}},{key:"csrfToken",value:function(){var r;return typeof window<"u"&&window.Laravel&&window.Laravel.csrfToken?window.Laravel.csrfToken:this.options.csrfToken?this.options.csrfToken:typeof document<"u"&&typeof document.querySelector=="function"&&(r=document.querySelector('meta[name="csrf-token"]'))?r.getAttribute("content"):null}}]),p}(),Qt=function(p){ie(r,p);var d=se(r);function r(){var a;return Y(this,r),a=d.apply(this,arguments),a.channels={},a}return Z(r,[{key:"connect",value:function(){typeof this.options.client<"u"?this.pusher=this.options.client:this.options.Pusher?this.pusher=new this.options.Pusher(this.options.key,this.options):this.pusher=new Pusher(this.options.key,this.options)}},{key:"signin",value:function(){this.pusher.signin()}},{key:"listen",value:function(o,l,c){return this.channel(o).listen(l,c)}},{key:"channel",value:function(o){return this.channels[o]||(this.channels[o]=new Xe(this.pusher,o,this.options)),this.channels[o]}},{key:"privateChannel",value:function(o){return this.channels["private-"+o]||(this.channels["private-"+o]=new uo(this.pusher,"private-"+o,this.options)),this.channels["private-"+o]}},{key:"encryptedPrivateChannel",value:function(o){return this.channels["private-encrypted-"+o]||(this.channels["private-encrypted-"+o]=new ho(this.pusher,"private-encrypted-"+o,this.options)),this.channels["private-encrypted-"+o]}},{key:"presenceChannel",value:function(o){return this.channels["presence-"+o]||(this.channels["presence-"+o]=new fo(this.pusher,"presence-"+o,this.options)),this.channels["presence-"+o]}},{key:"leave",value:function(o){var l=this,c=[o,"private-"+o,"private-encrypted-"+o,"presence-"+o];c.forEach(function(m,v){l.leaveChannel(m)})}},{key:"leaveChannel",value:function(o){this.channels[o]&&(this.channels[o].unsubscribe(),delete this.channels[o])}},{key:"socketId",value:function(){return this.pusher.connection.socket_id}},{key:"disconnect",value:function(){this.pusher.disconnect()}}]),r}(dt),go=function(p){ie(r,p);var d=se(r);function r(){var a;return Y(this,r),a=d.apply(this,arguments),a.channels={},a}return Z(r,[{key:"connect",value:function(){var o=this,l=this.getSocketIO();return this.socket=l(this.options.host,this.options),this.socket.on("reconnect",function(){Object.values(o.channels).forEach(function(c){c.subscribe()})}),this.socket}},{key:"getSocketIO",value:function(){if(typeof this.options.client<"u")return this.options.client;if(typeof io<"u")return io;throw new Error("Socket.io client not found. Should be globally available or passed via options.client")}},{key:"listen",value:function(o,l,c){return this.channel(o).listen(l,c)}},{key:"channel",value:function(o){return this.channels[o]||(this.channels[o]=new en(this.socket,o,this.options)),this.channels[o]}},{key:"privateChannel",value:function(o){return this.channels["private-"+o]||(this.channels["private-"+o]=new tn(this.socket,"private-"+o,this.options)),this.channels["private-"+o]}},{key:"presenceChannel",value:function(o){return this.channels["presence-"+o]||(this.channels["presence-"+o]=new po(this.socket,"presence-"+o,this.options)),this.channels["presence-"+o]}},{key:"leave",value:function(o){var l=this,c=[o,"private-"+o,"presence-"+o];c.forEach(function(m){l.leaveChannel(m)})}},{key:"leaveChannel",value:function(o){this.channels[o]&&(this.channels[o].unsubscribe(),delete this.channels[o])}},{key:"socketId",value:function(){return this.socket.id}},{key:"disconnect",value:function(){this.socket.disconnect()}}]),r}(dt),mo=function(p){ie(r,p);var d=se(r);function r(){var a;return Y(this,r),a=d.apply(this,arguments),a.channels={},a}return Z(r,[{key:"connect",value:function(){}},{key:"listen",value:function(o,l,c){return new Be}},{key:"channel",value:function(o){return new Be}},{key:"privateChannel",value:function(o){return new Gt}},{key:"encryptedPrivateChannel",value:function(o){return new Gt}},{key:"presenceChannel",value:function(o){return new vo}},{key:"leave",value:function(o){}},{key:"leaveChannel",value:function(o){}},{key:"socketId",value:function(){return"fake-socket-id"}},{key:"disconnect",value:function(){}}]),r}(dt),bo=function(){function p(d){Y(this,p),this.options=d,this.connect(),this.options.withoutInterceptors||this.registerInterceptors()}return Z(p,[{key:"channel",value:function(r){return this.connector.channel(r)}},{key:"connect",value:function(){if(this.options.broadcaster=="reverb")this.connector=new Qt(Le(Le({},this.options),{cluster:""}));else if(this.options.broadcaster=="pusher")this.connector=new Qt(this.options);else if(this.options.broadcaster=="socket.io")this.connector=new go(this.options);else if(this.options.broadcaster=="null")this.connector=new mo(this.options);else if(typeof this.options.broadcaster=="function")this.connector=new this.options.broadcaster(this.options);else throw new Error("Broadcaster ".concat(He(this.options.broadcaster)," ").concat(this.options.broadcaster," is not supported."))}},{key:"disconnect",value:function(){this.connector.disconnect()}},{key:"join",value:function(r){return this.connector.presenceChannel(r)}},{key:"leave",value:function(r){this.connector.leave(r)}},{key:"leaveChannel",value:function(r){this.connector.leaveChannel(r)}},{key:"leaveAllChannels",value:function(){for(var r in this.connector.channels)this.leaveChannel(r)}},{key:"listen",value:function(r,a,o){return this.connector.listen(r,a,o)}},{key:"private",value:function(r){return this.connector.privateChannel(r)}},{key:"encryptedPrivate",value:function(r){return this.connector.encryptedPrivateChannel(r)}},{key:"socketId",value:function(){return this.connector.socketId()}},{key:"registerInterceptors",value:function(){typeof Vue=="function"&&Vue.http&&this.registerVueRequestInterceptor(),typeof axios=="function"&&this.registerAxiosRequestInterceptor(),typeof jQuery=="function"&&this.registerjQueryAjaxSetup(),(typeof Turbo>"u"?"undefined":He(Turbo))==="object"&&this.registerTurboRequestInterceptor()}},{key:"registerVueRequestInterceptor",value:function(){var r=this;Vue.http.interceptors.push(function(a,o){r.socketId()&&a.headers.set("X-Socket-ID",r.socketId()),o()})}},{key:"registerAxiosRequestInterceptor",value:function(){var r=this;axios.interceptors.request.use(function(a){return r.socketId()&&(a.headers["X-Socket-Id"]=r.socketId()),a})}},{key:"registerjQueryAjaxSetup",value:function(){var r=this;typeof jQuery.ajax<"u"&&jQuery.ajaxPrefilter(function(a,o,l){r.socketId()&&l.setRequestHeader("X-Socket-Id",r.socketId())})}},{key:"registerTurboRequestInterceptor",value:function(){var r=this;document.addEventListener("turbo:before-fetch-request",function(a){a.detail.fetchOptions.headers["X-Socket-Id"]=r.socketId()})}}]),p}(),nn={exports:{}};/*!
 * Pusher JavaScript Library v8.4.0-rc2
 * https://pusher.com/
 *
 * Copyright 2020, Pusher
 * Released under the MIT licence.
 */(function(p,d){(function(a,o){p.exports=o()})(window,function(){return function(r){var a={};function o(l){if(a[l])return a[l].exports;var c=a[l]={i:l,l:!1,exports:{}};return r[l].call(c.exports,c,c.exports,o),c.l=!0,c.exports}return o.m=r,o.c=a,o.d=function(l,c,m){o.o(l,c)||Object.defineProperty(l,c,{enumerable:!0,get:m})},o.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},o.t=function(l,c){if(c&1&&(l=o(l)),c&8||c&4&&typeof l=="object"&&l&&l.__esModule)return l;var m=Object.create(null);if(o.r(m),Object.defineProperty(m,"default",{enumerable:!0,value:l}),c&2&&typeof l!="string")for(var v in l)o.d(m,v,(function(w){return l[w]}).bind(null,v));return m},o.n=function(l){var c=l&&l.__esModule?function(){return l.default}:function(){return l};return o.d(c,"a",c),c},o.o=function(l,c){return Object.prototype.hasOwnProperty.call(l,c)},o.p="",o(o.s=2)}([function(r,a,o){var l=this&&this.__extends||function(){var S=function(f,_){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,$){k.__proto__=$}||function(k,$){for(var J in $)$.hasOwnProperty(J)&&(k[J]=$[J])},S(f,_)};return function(f,_){S(f,_);function k(){this.constructor=f}f.prototype=_===null?Object.create(_):(k.prototype=_.prototype,new k)}}();Object.defineProperty(a,"__esModule",{value:!0});var c=256,m=function(){function S(f){f===void 0&&(f="="),this._paddingCharacter=f}return S.prototype.encodedLength=function(f){return this._paddingCharacter?(f+2)/3*4|0:(f*8+5)/6|0},S.prototype.encode=function(f){for(var _="",k=0;k<f.length-2;k+=3){var $=f[k]<<16|f[k+1]<<8|f[k+2];_+=this._encodeByte($>>>3*6&63),_+=this._encodeByte($>>>2*6&63),_+=this._encodeByte($>>>1*6&63),_+=this._encodeByte($>>>0*6&63)}var J=f.length-k;if(J>0){var $=f[k]<<16|(J===2?f[k+1]<<8:0);_+=this._encodeByte($>>>3*6&63),_+=this._encodeByte($>>>2*6&63),J===2?_+=this._encodeByte($>>>1*6&63):_+=this._paddingCharacter||"",_+=this._paddingCharacter||""}return _},S.prototype.maxDecodedLength=function(f){return this._paddingCharacter?f/4*3|0:(f*6+7)/8|0},S.prototype.decodedLength=function(f){return this.maxDecodedLength(f.length-this._getPaddingLength(f))},S.prototype.decode=function(f){if(f.length===0)return new Uint8Array(0);for(var _=this._getPaddingLength(f),k=f.length-_,$=new Uint8Array(this.maxDecodedLength(k)),J=0,Q=0,te=0,V=0,g=0,re=0,oe=0;Q<k-4;Q+=4)V=this._decodeChar(f.charCodeAt(Q+0)),g=this._decodeChar(f.charCodeAt(Q+1)),re=this._decodeChar(f.charCodeAt(Q+2)),oe=this._decodeChar(f.charCodeAt(Q+3)),$[J++]=V<<2|g>>>4,$[J++]=g<<4|re>>>2,$[J++]=re<<6|oe,te|=V&c,te|=g&c,te|=re&c,te|=oe&c;if(Q<k-1&&(V=this._decodeChar(f.charCodeAt(Q)),g=this._decodeChar(f.charCodeAt(Q+1)),$[J++]=V<<2|g>>>4,te|=V&c,te|=g&c),Q<k-2&&(re=this._decodeChar(f.charCodeAt(Q+2)),$[J++]=g<<4|re>>>2,te|=re&c),Q<k-3&&(oe=this._decodeChar(f.charCodeAt(Q+3)),$[J++]=re<<6|oe,te|=oe&c),te!==0)throw new Error("Base64Coder: incorrect characters for decoding");return $},S.prototype._encodeByte=function(f){var _=f;return _+=65,_+=25-f>>>8&6,_+=51-f>>>8&-75,_+=61-f>>>8&-15,_+=62-f>>>8&3,String.fromCharCode(_)},S.prototype._decodeChar=function(f){var _=c;return _+=(42-f&f-44)>>>8&-c+f-43+62,_+=(46-f&f-48)>>>8&-c+f-47+63,_+=(47-f&f-58)>>>8&-c+f-48+52,_+=(64-f&f-91)>>>8&-c+f-65+0,_+=(96-f&f-123)>>>8&-c+f-97+26,_},S.prototype._getPaddingLength=function(f){var _=0;if(this._paddingCharacter){for(var k=f.length-1;k>=0&&f[k]===this._paddingCharacter;k--)_++;if(f.length<4||_>2)throw new Error("Base64Coder: incorrect padding")}return _},S}();a.Coder=m;var v=new m;function w(S){return v.encode(S)}a.encode=w;function y(S){return v.decode(S)}a.decode=y;var C=function(S){l(f,S);function f(){return S!==null&&S.apply(this,arguments)||this}return f.prototype._encodeByte=function(_){var k=_;return k+=65,k+=25-_>>>8&6,k+=51-_>>>8&-75,k+=61-_>>>8&-13,k+=62-_>>>8&49,String.fromCharCode(k)},f.prototype._decodeChar=function(_){var k=c;return k+=(44-_&_-46)>>>8&-c+_-45+62,k+=(94-_&_-96)>>>8&-c+_-95+63,k+=(47-_&_-58)>>>8&-c+_-48+52,k+=(64-_&_-91)>>>8&-c+_-65+0,k+=(96-_&_-123)>>>8&-c+_-97+26,k},f}(m);a.URLSafeCoder=C;var T=new C;function R(S){return T.encode(S)}a.encodeURLSafe=R;function N(S){return T.decode(S)}a.decodeURLSafe=N,a.encodedLength=function(S){return v.encodedLength(S)},a.maxDecodedLength=function(S){return v.maxDecodedLength(S)},a.decodedLength=function(S){return v.decodedLength(S)}},function(r,a,o){Object.defineProperty(a,"__esModule",{value:!0});var l="utf8: invalid string",c="utf8: invalid source encoding";function m(y){for(var C=new Uint8Array(v(y)),T=0,R=0;R<y.length;R++){var N=y.charCodeAt(R);N<128?C[T++]=N:N<2048?(C[T++]=192|N>>6,C[T++]=128|N&63):N<55296?(C[T++]=224|N>>12,C[T++]=128|N>>6&63,C[T++]=128|N&63):(R++,N=(N&1023)<<10,N|=y.charCodeAt(R)&1023,N+=65536,C[T++]=240|N>>18,C[T++]=128|N>>12&63,C[T++]=128|N>>6&63,C[T++]=128|N&63)}return C}a.encode=m;function v(y){for(var C=0,T=0;T<y.length;T++){var R=y.charCodeAt(T);if(R<128)C+=1;else if(R<2048)C+=2;else if(R<55296)C+=3;else if(R<=57343){if(T>=y.length-1)throw new Error(l);T++,C+=4}else throw new Error(l)}return C}a.encodedLength=v;function w(y){for(var C=[],T=0;T<y.length;T++){var R=y[T];if(R&128){var N=void 0;if(R<224){if(T>=y.length)throw new Error(c);var S=y[++T];if((S&192)!==128)throw new Error(c);R=(R&31)<<6|S&63,N=128}else if(R<240){if(T>=y.length-1)throw new Error(c);var S=y[++T],f=y[++T];if((S&192)!==128||(f&192)!==128)throw new Error(c);R=(R&15)<<12|(S&63)<<6|f&63,N=2048}else if(R<248){if(T>=y.length-2)throw new Error(c);var S=y[++T],f=y[++T],_=y[++T];if((S&192)!==128||(f&192)!==128||(_&192)!==128)throw new Error(c);R=(R&15)<<18|(S&63)<<12|(f&63)<<6|_&63,N=65536}else throw new Error(c);if(R<N||R>=55296&&R<=57343)throw new Error(c);if(R>=65536){if(R>1114111)throw new Error(c);R-=65536,C.push(String.fromCharCode(55296|R>>10)),R=56320|R&1023}}C.push(String.fromCharCode(R))}return C.join("")}a.decode=w},function(r,a,o){r.exports=o(3).default},function(r,a,o){o.r(a);class l{constructor(e,t){this.lastId=0,this.prefix=e,this.name=t}create(e){this.lastId++;var t=this.lastId,i=this.prefix+t,s=this.name+"["+t+"]",h=!1,b=function(){h||(e.apply(null,arguments),h=!0)};return this[t]=b,{number:t,id:i,name:s,callback:b}}remove(e){delete this[e.number]}}var c=new l("_pusher_script_","Pusher.ScriptReceivers"),m={VERSION:"8.4.0-rc2",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,userAuthentication:{endpoint:"/pusher/user-auth",transport:"ajax"},channelAuthorization:{endpoint:"/pusher/auth",transport:"ajax"},cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""},v=m;class w{constructor(e){this.options=e,this.receivers=e.receivers||c,this.loading={}}load(e,t,i){var s=this;if(s.loading[e]&&s.loading[e].length>0)s.loading[e].push(i);else{s.loading[e]=[i];var h=E.createScriptRequest(s.getPath(e,t)),b=s.receivers.create(function(x){if(s.receivers.remove(b),s.loading[e]){var L=s.loading[e];delete s.loading[e];for(var D=function(G){G||h.cleanup()},H=0;H<L.length;H++)L[H](x,D)}});h.send(b)}}getRoot(e){var t,i=E.getDocument().location.protocol;return e&&e.useTLS||i==="https:"?t=this.options.cdn_https:t=this.options.cdn_http,t.replace(/\/*$/,"")+"/"+this.options.version}getPath(e,t){return this.getRoot(t)+"/"+e+this.options.suffix+".js"}}var y=new l("_pusher_dependencies","Pusher.DependenciesReceivers"),C=new w({cdn_http:v.cdn_http,cdn_https:v.cdn_https,version:v.VERSION,suffix:v.dependency_suffix,receivers:y});const T={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/channels/server_api/authenticating_users"},authorizationEndpoint:{path:"/docs/channels/server_api/authorizing-users/"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}};var N={buildLogSuffix:function(n){const e="See:",t=T.urls[n];if(!t)return"";let i;return t.fullUrl?i=t.fullUrl:t.path&&(i=T.baseUrl+t.path),i?`${e} ${i}`:""}},S;(function(n){n.UserAuthentication="user-authentication",n.ChannelAuthorization="channel-authorization"})(S||(S={}));class f extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class _ extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class k extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class $ extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class J extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class Q extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class te extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class V extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class g extends Error{constructor(e,t){super(t),this.status=e,Object.setPrototypeOf(this,new.target.prototype)}}var oe=function(n,e,t,i,s){const h=E.createXHR();h.open("POST",t.endpoint,!0),h.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var b in t.headers)h.setRequestHeader(b,t.headers[b]);if(t.headersProvider!=null){let x=t.headersProvider();for(var b in x)h.setRequestHeader(b,x[b])}return h.onreadystatechange=function(){if(h.readyState===4)if(h.status===200){let x,L=!1;try{x=JSON.parse(h.responseText),L=!0}catch{s(new g(200,`JSON returned from ${i.toString()} endpoint was invalid, yet status code was 200. Data was: ${h.responseText}`),null)}L&&s(null,x)}else{let x="";switch(i){case S.UserAuthentication:x=N.buildLogSuffix("authenticationEndpoint");break;case S.ChannelAuthorization:x=`Clients must be authorized to join private or presence channels. ${N.buildLogSuffix("authorizationEndpoint")}`;break}s(new g(h.status,`Unable to retrieve auth string from ${i.toString()} endpoint - received status: ${h.status} from ${t.endpoint}. ${x}`),null)}},h.send(e),h};function F(n){return We(Je(n))}var ve=String.fromCharCode,ke="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ae=function(n){var e=n.charCodeAt(0);return e<128?n:e<2048?ve(192|e>>>6)+ve(128|e&63):ve(224|e>>>12&15)+ve(128|e>>>6&63)+ve(128|e&63)},Je=function(n){return n.replace(/[^\x00-\x7F]/g,Ae)},Se=function(n){var e=[0,2,1][n.length%3],t=n.charCodeAt(0)<<16|(n.length>1?n.charCodeAt(1):0)<<8|(n.length>2?n.charCodeAt(2):0),i=[ke.charAt(t>>>18),ke.charAt(t>>>12&63),e>=2?"=":ke.charAt(t>>>6&63),e>=1?"=":ke.charAt(t&63)];return i.join("")},We=window.btoa||function(n){return n.replace(/[\s\S]{1,3}/g,Se)};class Ee{constructor(e,t,i,s){this.clear=t,this.timer=e(()=>{this.timer&&(this.timer=s(this.timer))},i)}isRunning(){return this.timer!==null}ensureAborted(){this.timer&&(this.clear(this.timer),this.timer=null)}}var Re=Ee;function j(n){window.clearTimeout(n)}function I(n){window.clearInterval(n)}class M extends Re{constructor(e,t){super(setTimeout,j,e,function(i){return t(),null})}}class ge extends Re{constructor(e,t){super(setInterval,I,e,function(i){return t(),i})}}var Ve={now(){return Date.now?Date.now():new Date().valueOf()},defer(n){return new M(0,n)},method(n,...e){var t=Array.prototype.slice.call(arguments,1);return function(i){return i[n].apply(i,t.concat(arguments))}}},U=Ve;function ee(n,...e){for(var t=0;t<e.length;t++){var i=e[t];for(var s in i)i[s]&&i[s].constructor&&i[s].constructor===Object?n[s]=ee(n[s]||{},i[s]):n[s]=i[s]}return n}function Ge(){for(var n=["Pusher"],e=0;e<arguments.length;e++)typeof arguments[e]=="string"?n.push(arguments[e]):n.push($e(arguments[e]));return n.join(" : ")}function ft(n,e){var t=Array.prototype.indexOf;if(n===null)return-1;if(t&&n.indexOf===t)return n.indexOf(e);for(var i=0,s=n.length;i<s;i++)if(n[i]===e)return i;return-1}function ue(n,e){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(n[t],t,n)}function pt(n){var e=[];return ue(n,function(t,i){e.push(i)}),e}function sn(n){var e=[];return ue(n,function(t){e.push(t)}),e}function Te(n,e,t){for(var i=0;i<n.length;i++)e.call(t||window,n[i],i,n)}function vt(n,e){for(var t=[],i=0;i<n.length;i++)t.push(e(n[i],i,n,t));return t}function rn(n,e){var t={};return ue(n,function(i,s){t[s]=e(i)}),t}function gt(n,e){e=e||function(s){return!!s};for(var t=[],i=0;i<n.length;i++)e(n[i],i,n,t)&&t.push(n[i]);return t}function mt(n,e){var t={};return ue(n,function(i,s){(e&&e(i,s,n,t)||i)&&(t[s]=i)}),t}function on(n){var e=[];return ue(n,function(t,i){e.push([i,t])}),e}function bt(n,e){for(var t=0;t<n.length;t++)if(e(n[t],t,n))return!0;return!1}function an(n,e){for(var t=0;t<n.length;t++)if(!e(n[t],t,n))return!1;return!0}function ln(n){return rn(n,function(e){return typeof e=="object"&&(e=$e(e)),encodeURIComponent(F(e.toString()))})}function cn(n){var e=mt(n,function(i){return i!==void 0}),t=vt(on(ln(e)),U.method("join","=")).join("&");return t}function un(n){var e=[],t=[];return function i(s,h){var b,x,L;switch(typeof s){case"object":if(!s)return null;for(b=0;b<e.length;b+=1)if(e[b]===s)return{$ref:t[b]};if(e.push(s),t.push(h),Object.prototype.toString.apply(s)==="[object Array]")for(L=[],b=0;b<s.length;b+=1)L[b]=i(s[b],h+"["+b+"]");else{L={};for(x in s)Object.prototype.hasOwnProperty.call(s,x)&&(L[x]=i(s[x],h+"["+JSON.stringify(x)+"]"))}return L;case"number":case"string":case"boolean":return s}}(n,"$")}function $e(n){try{return JSON.stringify(n)}catch{return JSON.stringify(un(n))}}class hn{constructor(){this.globalLog=e=>{window.console&&window.console.log&&window.console.log(e)}}debug(...e){this.log(this.globalLog,e)}warn(...e){this.log(this.globalLogWarn,e)}error(...e){this.log(this.globalLogError,e)}globalLogWarn(e){window.console&&window.console.warn?window.console.warn(e):this.globalLog(e)}globalLogError(e){window.console&&window.console.error?window.console.error(e):this.globalLogWarn(e)}log(e,...t){var i=Ge.apply(this,arguments);ot.log?ot.log(i):ot.logToConsole&&e.bind(this)(i)}}var X=new hn,dn=function(n,e,t,i,s){(t.headers!==void 0||t.headersProvider!=null)&&X.warn(`To send headers with the ${i.toString()} request, you must use AJAX, rather than JSONP.`);var h=n.nextAuthCallbackID.toString();n.nextAuthCallbackID++;var b=n.getDocument(),x=b.createElement("script");n.auth_callbacks[h]=function(H){s(null,H)};var L="Pusher.auth_callbacks['"+h+"']";x.src=t.endpoint+"?callback="+encodeURIComponent(L)+"&"+e;var D=b.getElementsByTagName("head")[0]||b.documentElement;D.insertBefore(x,D.firstChild)},fn=dn;class pn{constructor(e){this.src=e}send(e){var t=this,i="Error loading "+t.src;t.script=document.createElement("script"),t.script.id=e.id,t.script.src=t.src,t.script.type="text/javascript",t.script.charset="UTF-8",t.script.addEventListener?(t.script.onerror=function(){e.callback(i)},t.script.onload=function(){e.callback(null)}):t.script.onreadystatechange=function(){(t.script.readyState==="loaded"||t.script.readyState==="complete")&&e.callback(null)},t.script.async===void 0&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(t.errorScript=document.createElement("script"),t.errorScript.id=e.id+"_error",t.errorScript.text=e.name+"('"+i+"');",t.script.async=t.errorScript.async=!1):t.script.async=!0;var s=document.getElementsByTagName("head")[0];s.insertBefore(t.script,s.firstChild),t.errorScript&&s.insertBefore(t.errorScript,t.script.nextSibling)}cleanup(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null}}class vn{constructor(e,t){this.url=e,this.data=t}send(e){if(!this.request){var t=cn(this.data),i=this.url+"/"+e.number+"?"+t;this.request=E.createScriptRequest(i),this.request.send(e)}}cleanup(){this.request&&this.request.cleanup()}}var gn=function(n,e){return function(t,i){var s="http"+(e?"s":"")+"://",h=s+(n.host||n.options.host)+n.options.path,b=E.createJSONPRequest(h,t),x=E.ScriptReceivers.create(function(L,D){c.remove(x),b.cleanup(),D&&D.host&&(n.host=D.host),i&&i(L,D)});b.send(x)}},mn={name:"jsonp",getAgent:gn},bn=mn;function Qe(n,e,t){var i=n+(e.useTLS?"s":""),s=e.useTLS?e.hostTLS:e.hostNonTLS;return i+"://"+s+t}function Ke(n,e){var t="/app/"+n,i="?protocol="+v.PROTOCOL+"&client=js&version="+v.VERSION+(e?"&"+e:"");return t+i}var _n={getInitial:function(n,e){var t=(e.httpPath||"")+Ke(n,"flash=false");return Qe("ws",e,t)}},yn={getInitial:function(n,e){var t=(e.httpPath||"/pusher")+Ke(n);return Qe("http",e,t)}},wn={getInitial:function(n,e){return Qe("http",e,e.httpPath||"/pusher")},getPath:function(n,e){return Ke(n)}};class kn{constructor(){this._callbacks={}}get(e){return this._callbacks[Ye(e)]}add(e,t,i){var s=Ye(e);this._callbacks[s]=this._callbacks[s]||[],this._callbacks[s].push({fn:t,context:i})}remove(e,t,i){if(!e&&!t&&!i){this._callbacks={};return}var s=e?[Ye(e)]:pt(this._callbacks);t||i?this.removeCallback(s,t,i):this.removeAllCallbacks(s)}removeCallback(e,t,i){Te(e,function(s){this._callbacks[s]=gt(this._callbacks[s]||[],function(h){return t&&t!==h.fn||i&&i!==h.context}),this._callbacks[s].length===0&&delete this._callbacks[s]},this)}removeAllCallbacks(e){Te(e,function(t){delete this._callbacks[t]},this)}}function Ye(n){return"_"+n}class he{constructor(e){this.callbacks=new kn,this.global_callbacks=[],this.failThrough=e}bind(e,t,i){return this.callbacks.add(e,t,i),this}bind_global(e){return this.global_callbacks.push(e),this}unbind(e,t,i){return this.callbacks.remove(e,t,i),this}unbind_global(e){return e?(this.global_callbacks=gt(this.global_callbacks||[],t=>t!==e),this):(this.global_callbacks=[],this)}unbind_all(){return this.unbind(),this.unbind_global(),this}emit(e,t,i){for(var s=0;s<this.global_callbacks.length;s++)this.global_callbacks[s](e,t);var h=this.callbacks.get(e),b=[];if(i?b.push(t,i):t&&b.push(t),h&&h.length>0)for(var s=0;s<h.length;s++)h[s].fn.apply(h[s].context||window,b);else this.failThrough&&this.failThrough(e,t);return this}}class xn extends he{constructor(e,t,i,s,h){super(),this.initialize=E.transportConnectionInitializer,this.hooks=e,this.name=t,this.priority=i,this.key=s,this.options=h,this.state="new",this.timeline=h.timeline,this.activityTimeout=h.activityTimeout,this.id=this.timeline.generateUniqueID()}handlesActivityChecks(){return!!this.hooks.handlesActivityChecks}supportsPing(){return!!this.hooks.supportsPing}connect(){if(this.socket||this.state!=="initialized")return!1;var e=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(e,this.options)}catch(t){return U.defer(()=>{this.onError(t),this.changeState("closed")}),!1}return this.bindListeners(),X.debug("Connecting",{transport:this.name,url:e}),this.changeState("connecting"),!0}close(){return this.socket?(this.socket.close(),!0):!1}send(e){return this.state==="open"?(U.defer(()=>{this.socket&&this.socket.send(e)}),!0):!1}ping(){this.state==="open"&&this.supportsPing()&&this.socket.ping()}onOpen(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0}onError(e){this.emit("error",{type:"WebSocketError",error:e}),this.timeline.error(this.buildTimelineMessage({error:e.toString()}))}onClose(e){e?this.changeState("closed",{code:e.code,reason:e.reason,wasClean:e.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0}onMessage(e){this.emit("message",e)}onActivity(){this.emit("activity")}bindListeners(){this.socket.onopen=()=>{this.onOpen()},this.socket.onerror=e=>{this.onError(e)},this.socket.onclose=e=>{this.onClose(e)},this.socket.onmessage=e=>{this.onMessage(e)},this.supportsPing()&&(this.socket.onactivity=()=>{this.onActivity()})}unbindListeners(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))}changeState(e,t){this.state=e,this.timeline.info(this.buildTimelineMessage({state:e,params:t})),this.emit(e,t)}buildTimelineMessage(e){return ee({cid:this.id},e)}}class xe{constructor(e){this.hooks=e}isSupported(e){return this.hooks.isSupported(e)}createConnection(e,t,i,s){return new xn(this.hooks,e,t,i,s)}}var Cn=new xe({urls:_n,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return!!E.getWebSocketAPI()},isSupported:function(){return!!E.getWebSocketAPI()},getSocket:function(n){return E.createWebSocket(n)}}),_t={urls:yn,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},yt=ee({getSocket:function(n){return E.HTTPFactory.createStreamingSocket(n)}},_t),wt=ee({getSocket:function(n){return E.HTTPFactory.createPollingSocket(n)}},_t),kt={isSupported:function(){return E.isXHRSupported()}},Sn=new xe(ee({},yt,kt)),Tn=new xe(ee({},wt,kt)),Pn={ws:Cn,xhr_streaming:Sn,xhr_polling:Tn},Ne=Pn,jn=new xe({file:"sockjs",urls:wn,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return window.SockJS!==void 0},getSocket:function(n,e){return new window.SockJS(n,null,{js_path:C.getPath("sockjs",{useTLS:e.useTLS}),ignore_null_origin:e.ignoreNullOrigin})},beforeOpen:function(n,e){n.send(JSON.stringify({path:e}))}}),xt={isSupported:function(n){var e=E.isXDRSupported(n.useTLS);return e}},On=new xe(ee({},yt,xt)),In=new xe(ee({},wt,xt));Ne.xdr_streaming=On,Ne.xdr_polling=In,Ne.sockjs=jn;var Ln=Ne;class An extends he{constructor(){super();var e=this;window.addEventListener!==void 0&&(window.addEventListener("online",function(){e.emit("online")},!1),window.addEventListener("offline",function(){e.emit("offline")},!1))}isOnline(){return window.navigator.onLine===void 0?!0:window.navigator.onLine}}var En=new An;class Rn{constructor(e,t,i){this.manager=e,this.transport=t,this.minPingDelay=i.minPingDelay,this.maxPingDelay=i.maxPingDelay,this.pingDelay=void 0}createConnection(e,t,i,s){s=ee({},s,{activityTimeout:this.pingDelay});var h=this.transport.createConnection(e,t,i,s),b=null,x=function(){h.unbind("open",x),h.bind("closed",L),b=U.now()},L=D=>{if(h.unbind("closed",L),D.code===1002||D.code===1003)this.manager.reportDeath();else if(!D.wasClean&&b){var H=U.now()-b;H<2*this.maxPingDelay&&(this.manager.reportDeath(),this.pingDelay=Math.max(H/2,this.minPingDelay))}};return h.bind("open",x),h}isSupported(e){return this.manager.isAlive()&&this.transport.isSupported(e)}}const Ct={decodeMessage:function(n){try{var e=JSON.parse(n.data),t=e.data;if(typeof t=="string")try{t=JSON.parse(e.data)}catch{}var i={event:e.event,channel:e.channel,data:t};return e.user_id&&(i.user_id=e.user_id),i}catch(s){throw{type:"MessageParseError",error:s,data:n.data}}},encodeMessage:function(n){return JSON.stringify(n)},processHandshake:function(n){var e=Ct.decodeMessage(n);if(e.event==="pusher:connection_established"){if(!e.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:e.data.socket_id,activityTimeout:e.data.activity_timeout*1e3}}else{if(e.event==="pusher:error")return{action:this.getCloseAction(e.data),error:this.getCloseError(e.data)};throw"Invalid handshake"}},getCloseAction:function(n){return n.code<4e3?n.code>=1002&&n.code<=1004?"backoff":null:n.code===4e3?"tls_only":n.code<4100?"refused":n.code<4200?"backoff":n.code<4300?"retry":"refused"},getCloseError:function(n){return n.code!==1e3&&n.code!==1001?{type:"PusherError",data:{code:n.code,message:n.reason||n.message}}:null}};var me=Ct;class $n extends he{constructor(e,t){super(),this.id=e,this.transport=t,this.activityTimeout=t.activityTimeout,this.bindListeners()}handlesActivityChecks(){return this.transport.handlesActivityChecks()}send(e){return this.transport.send(e)}send_event(e,t,i){var s={event:e,data:t};return i&&(s.channel=i),X.debug("Event sent",s),this.send(me.encodeMessage(s))}ping(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})}close(){this.transport.close()}bindListeners(){var e={message:i=>{var s;try{s=me.decodeMessage(i)}catch(h){this.emit("error",{type:"MessageParseError",error:h,data:i.data})}if(s!==void 0){switch(X.debug("Event recd",s),s.event){case"pusher:error":this.emit("error",{type:"PusherError",data:s.data});break;case"pusher:ping":this.emit("ping");break;case"pusher:pong":this.emit("pong");break}this.emit("message",s)}},activity:()=>{this.emit("activity")},error:i=>{this.emit("error",i)},closed:i=>{t(),i&&i.code&&this.handleCloseEvent(i),this.transport=null,this.emit("closed")}},t=()=>{ue(e,(i,s)=>{this.transport.unbind(s,i)})};ue(e,(i,s)=>{this.transport.bind(s,i)})}handleCloseEvent(e){var t=me.getCloseAction(e),i=me.getCloseError(e);i&&this.emit("error",i),t&&this.emit(t,{action:t,error:i})}}class Nn{constructor(e,t){this.transport=e,this.callback=t,this.bindListeners()}close(){this.unbindListeners(),this.transport.close()}bindListeners(){this.onMessage=e=>{this.unbindListeners();var t;try{t=me.processHandshake(e)}catch(i){this.finish("error",{error:i}),this.transport.close();return}t.action==="connected"?this.finish("connected",{connection:new $n(t.id,this.transport),activityTimeout:t.activityTimeout}):(this.finish(t.action,{error:t.error}),this.transport.close())},this.onClosed=e=>{this.unbindListeners();var t=me.getCloseAction(e)||"backoff",i=me.getCloseError(e);this.finish(t,{error:i})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)}unbindListeners(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)}finish(e,t){this.callback(ee({transport:this.transport,action:e},t))}}class zn{constructor(e,t){this.timeline=e,this.options=t||{}}send(e,t){this.timeline.isEmpty()||this.timeline.send(E.TimelineTransport.getAgent(this,e),t)}}class Ze extends he{constructor(e,t){super(function(i,s){X.debug("No callbacks on "+e+" for "+i)}),this.name=e,this.pusher=t,this.subscribed=!1,this.subscriptionPending=!1,this.subscriptionCancelled=!1}authorize(e,t){return t(null,{auth:""})}trigger(e,t){if(e.indexOf("client-")!==0)throw new f("Event '"+e+"' does not start with 'client-'");if(!this.subscribed){var i=N.buildLogSuffix("triggeringClientEvents");X.warn(`Client event triggered before channel 'subscription_succeeded' event . ${i}`)}return this.pusher.send_event(e,t,this.name)}disconnect(){this.subscribed=!1,this.subscriptionPending=!1}handleEvent(e){var t=e.event,i=e.data;if(t==="pusher_internal:subscription_succeeded")this.handleSubscriptionSucceededEvent(e);else if(t==="pusher_internal:subscription_count")this.handleSubscriptionCountEvent(e);else if(t.indexOf("pusher_internal:")!==0){var s={};this.emit(t,i,s)}}handleSubscriptionSucceededEvent(e){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",e.data)}handleSubscriptionCountEvent(e){e.data.subscription_count&&(this.subscriptionCount=e.data.subscription_count),this.emit("pusher:subscription_count",e.data)}subscribe(){this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,(e,t)=>{e?(this.subscriptionPending=!1,X.error(e.toString()),this.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:e.message},e instanceof g?{status:e.status}:{}))):this.pusher.send_event("pusher:subscribe",{auth:t.auth,channel_data:t.channel_data,channel:this.name})}))}unsubscribe(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})}cancelSubscription(){this.subscriptionCancelled=!0}reinstateSubscription(){this.subscriptionCancelled=!1}}class et extends Ze{authorize(e,t){return this.pusher.config.channelAuthorizer({channelName:this.name,socketId:e},t)}}class Dn{constructor(){this.reset()}get(e){return Object.prototype.hasOwnProperty.call(this.members,e)?{id:e,info:this.members[e]}:null}each(e){ue(this.members,(t,i)=>{e(this.get(i))})}setMyID(e){this.myID=e}onSubscription(e){this.members=e.presence.hash,this.count=e.presence.count,this.me=this.get(this.myID)}addMember(e){return this.get(e.user_id)===null&&this.count++,this.members[e.user_id]=e.user_info,this.get(e.user_id)}removeMember(e){var t=this.get(e.user_id);return t&&(delete this.members[e.user_id],this.count--),t}reset(){this.members={},this.count=0,this.myID=null,this.me=null}}var Mn=function(n,e,t,i){function s(h){return h instanceof t?h:new t(function(b){b(h)})}return new(t||(t=Promise))(function(h,b){function x(H){try{D(i.next(H))}catch(G){b(G)}}function L(H){try{D(i.throw(H))}catch(G){b(G)}}function D(H){H.done?h(H.value):s(H.value).then(x,L)}D((i=i.apply(n,e||[])).next())})};class Un extends et{constructor(e,t){super(e,t),this.members=new Dn}authorize(e,t){super.authorize(e,(i,s)=>Mn(this,void 0,void 0,function*(){if(!i)if(s=s,s.channel_data!=null){var h=JSON.parse(s.channel_data);this.members.setMyID(h.user_id)}else if(yield this.pusher.user.signinDonePromise,this.pusher.user.user_data!=null)this.members.setMyID(this.pusher.user.user_data.id);else{let b=N.buildLogSuffix("authorizationEndpoint");X.error(`Invalid auth response for channel '${this.name}', expected 'channel_data' field. ${b}, or the user should be signed in.`),t("Invalid auth response");return}t(i,s)}))}handleEvent(e){var t=e.event;if(t.indexOf("pusher_internal:")===0)this.handleInternalEvent(e);else{var i=e.data,s={};e.user_id&&(s.user_id=e.user_id),this.emit(t,i,s)}}handleInternalEvent(e){var t=e.event,i=e.data;switch(t){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(e);break;case"pusher_internal:subscription_count":this.handleSubscriptionCountEvent(e);break;case"pusher_internal:member_added":var s=this.members.addMember(i);this.emit("pusher:member_added",s);break;case"pusher_internal:member_removed":var h=this.members.removeMember(i);h&&this.emit("pusher:member_removed",h);break}}handleSubscriptionSucceededEvent(e){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(e.data),this.emit("pusher:subscription_succeeded",this.members))}disconnect(){this.members.reset(),super.disconnect()}}var Hn=o(1),tt=o(0);class qn extends et{constructor(e,t,i){super(e,t),this.key=null,this.nacl=i}authorize(e,t){super.authorize(e,(i,s)=>{if(i){t(i,s);return}let h=s.shared_secret;if(!h){t(new Error(`No shared_secret key in auth payload for encrypted channel: ${this.name}`),null);return}this.key=Object(tt.decode)(h),delete s.shared_secret,t(null,s)})}trigger(e,t){throw new Q("Client events are not currently supported for encrypted channels")}handleEvent(e){var t=e.event,i=e.data;if(t.indexOf("pusher_internal:")===0||t.indexOf("pusher:")===0){super.handleEvent(e);return}this.handleEncryptedEvent(t,i)}handleEncryptedEvent(e,t){if(!this.key){X.debug("Received encrypted event before key has been retrieved from the authEndpoint");return}if(!t.ciphertext||!t.nonce){X.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+t);return}let i=Object(tt.decode)(t.ciphertext);if(i.length<this.nacl.secretbox.overheadLength){X.error(`Expected encrypted event ciphertext length to be ${this.nacl.secretbox.overheadLength}, got: ${i.length}`);return}let s=Object(tt.decode)(t.nonce);if(s.length<this.nacl.secretbox.nonceLength){X.error(`Expected encrypted event nonce length to be ${this.nacl.secretbox.nonceLength}, got: ${s.length}`);return}let h=this.nacl.secretbox.open(i,s,this.key);if(h===null){X.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),this.authorize(this.pusher.connection.socket_id,(b,x)=>{if(b){X.error(`Failed to make a request to the authEndpoint: ${x}. Unable to fetch new key, so dropping encrypted event`);return}if(h=this.nacl.secretbox.open(i,s,this.key),h===null){X.error("Failed to decrypt event with new key. Dropping encrypted event");return}this.emit(e,this.getDataToEmit(h))});return}this.emit(e,this.getDataToEmit(h))}getDataToEmit(e){let t=Object(Hn.decode)(e);try{return JSON.parse(t)}catch{return t}}}class Bn extends he{constructor(e,t){super(),this.state="initialized",this.connection=null,this.key=e,this.options=t,this.timeline=this.options.timeline,this.usingTLS=this.options.useTLS,this.errorCallbacks=this.buildErrorCallbacks(),this.connectionCallbacks=this.buildConnectionCallbacks(this.errorCallbacks),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var i=E.getNetwork();i.bind("online",()=>{this.timeline.info({netinfo:"online"}),(this.state==="connecting"||this.state==="unavailable")&&this.retryIn(0)}),i.bind("offline",()=>{this.timeline.info({netinfo:"offline"}),this.connection&&this.sendActivityCheck()}),this.updateStrategy()}switchCluster(e){this.key=e,this.updateStrategy(),this.retryIn(0)}connect(){if(!(this.connection||this.runner)){if(!this.strategy.isSupported()){this.updateState("failed");return}this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()}}send(e){return this.connection?this.connection.send(e):!1}send_event(e,t,i){return this.connection?this.connection.send_event(e,t,i):!1}disconnect(){this.disconnectInternally(),this.updateState("disconnected")}isUsingTLS(){return this.usingTLS}startConnecting(){var e=(t,i)=>{t?this.runner=this.strategy.connect(0,e):i.action==="error"?(this.emit("error",{type:"HandshakeError",error:i.error}),this.timeline.error({handshakeError:i.error})):(this.abortConnecting(),this.handshakeCallbacks[i.action](i))};this.runner=this.strategy.connect(0,e)}abortConnecting(){this.runner&&(this.runner.abort(),this.runner=null)}disconnectInternally(){if(this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection){var e=this.abandonConnection();e.close()}}updateStrategy(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})}retryIn(e){this.timeline.info({action:"retry",delay:e}),e>0&&this.emit("connecting_in",Math.round(e/1e3)),this.retryTimer=new M(e||0,()=>{this.disconnectInternally(),this.connect()})}clearRetryTimer(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)}setUnavailableTimer(){this.unavailableTimer=new M(this.options.unavailableTimeout,()=>{this.updateState("unavailable")})}clearUnavailableTimer(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()}sendActivityCheck(){this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new M(this.options.pongTimeout,()=>{this.timeline.error({pong_timed_out:this.options.pongTimeout}),this.retryIn(0)})}resetActivityCheck(){this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new M(this.activityTimeout,()=>{this.sendActivityCheck()}))}stopActivityCheck(){this.activityTimer&&this.activityTimer.ensureAborted()}buildConnectionCallbacks(e){return ee({},e,{message:t=>{this.resetActivityCheck(),this.emit("message",t)},ping:()=>{this.send_event("pusher:pong",{})},activity:()=>{this.resetActivityCheck()},error:t=>{this.emit("error",t)},closed:()=>{this.abandonConnection(),this.shouldRetry()&&this.retryIn(1e3)}})}buildHandshakeCallbacks(e){return ee({},e,{connected:t=>{this.activityTimeout=Math.min(this.options.activityTimeout,t.activityTimeout,t.connection.activityTimeout||1/0),this.clearUnavailableTimer(),this.setConnection(t.connection),this.socket_id=this.connection.id,this.updateState("connected",{socket_id:this.socket_id})}})}buildErrorCallbacks(){let e=t=>i=>{i.error&&this.emit("error",{type:"WebSocketError",error:i.error}),t(i)};return{tls_only:e(()=>{this.usingTLS=!0,this.updateStrategy(),this.retryIn(0)}),refused:e(()=>{this.disconnect()}),backoff:e(()=>{this.retryIn(1e3)}),retry:e(()=>{this.retryIn(0)})}}setConnection(e){this.connection=e;for(var t in this.connectionCallbacks)this.connection.bind(t,this.connectionCallbacks[t]);this.resetActivityCheck()}abandonConnection(){if(this.connection){this.stopActivityCheck();for(var e in this.connectionCallbacks)this.connection.unbind(e,this.connectionCallbacks[e]);var t=this.connection;return this.connection=null,t}}updateState(e,t){var i=this.state;if(this.state=e,i!==e){var s=e;s==="connected"&&(s+=" with new socket ID "+t.socket_id),X.debug("State changed",i+" -> "+s),this.timeline.info({state:e,params:t}),this.emit("state_change",{previous:i,current:e}),this.emit(e,t)}}shouldRetry(){return this.state==="connecting"||this.state==="connected"}}class Fn{constructor(){this.channels={}}add(e,t){return this.channels[e]||(this.channels[e]=Xn(e,t)),this.channels[e]}all(){return sn(this.channels)}find(e){return this.channels[e]}remove(e){var t=this.channels[e];return delete this.channels[e],t}disconnect(){ue(this.channels,function(e){e.disconnect()})}}function Xn(n,e){if(n.indexOf("private-encrypted-")===0){if(e.config.nacl)return de.createEncryptedChannel(n,e,e.config.nacl);let t="Tried to subscribe to a private-encrypted- channel but no nacl implementation available",i=N.buildLogSuffix("encryptedChannelSupport");throw new Q(`${t}. ${i}`)}else{if(n.indexOf("private-")===0)return de.createPrivateChannel(n,e);if(n.indexOf("presence-")===0)return de.createPresenceChannel(n,e);if(n.indexOf("#")===0)throw new _('Cannot create a channel with name "'+n+'".');return de.createChannel(n,e)}}var Jn={createChannels(){return new Fn},createConnectionManager(n,e){return new Bn(n,e)},createChannel(n,e){return new Ze(n,e)},createPrivateChannel(n,e){return new et(n,e)},createPresenceChannel(n,e){return new Un(n,e)},createEncryptedChannel(n,e,t){return new qn(n,e,t)},createTimelineSender(n,e){return new zn(n,e)},createHandshake(n,e){return new Nn(n,e)},createAssistantToTheTransportManager(n,e,t){return new Rn(n,e,t)}},de=Jn;class St{constructor(e){this.options=e||{},this.livesLeft=this.options.lives||1/0}getAssistant(e){return de.createAssistantToTheTransportManager(this,e,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})}isAlive(){return this.livesLeft>0}reportDeath(){this.livesLeft-=1}}class be{constructor(e,t){this.strategies=e,this.loop=!!t.loop,this.failFast=!!t.failFast,this.timeout=t.timeout,this.timeoutLimit=t.timeoutLimit}isSupported(){return bt(this.strategies,U.method("isSupported"))}connect(e,t){var i=this.strategies,s=0,h=this.timeout,b=null,x=(L,D)=>{D?t(null,D):(s=s+1,this.loop&&(s=s%i.length),s<i.length?(h&&(h=h*2,this.timeoutLimit&&(h=Math.min(h,this.timeoutLimit))),b=this.tryStrategy(i[s],e,{timeout:h,failFast:this.failFast},x)):t(!0))};return b=this.tryStrategy(i[s],e,{timeout:h,failFast:this.failFast},x),{abort:function(){b.abort()},forceMinPriority:function(L){e=L,b&&b.forceMinPriority(L)}}}tryStrategy(e,t,i,s){var h=null,b=null;return i.timeout>0&&(h=new M(i.timeout,function(){b.abort(),s(!0)})),b=e.connect(t,function(x,L){x&&h&&h.isRunning()&&!i.failFast||(h&&h.ensureAborted(),s(x,L))}),{abort:function(){h&&h.ensureAborted(),b.abort()},forceMinPriority:function(x){b.forceMinPriority(x)}}}}class nt{constructor(e){this.strategies=e}isSupported(){return bt(this.strategies,U.method("isSupported"))}connect(e,t){return Wn(this.strategies,e,function(i,s){return function(h,b){if(s[i].error=h,h){Vn(s)&&t(!0);return}Te(s,function(x){x.forceMinPriority(b.transport.priority)}),t(null,b)}})}}function Wn(n,e,t){var i=vt(n,function(s,h,b,x){return s.connect(e,t(h,x))});return{abort:function(){Te(i,Gn)},forceMinPriority:function(s){Te(i,function(h){h.forceMinPriority(s)})}}}function Vn(n){return an(n,function(e){return!!e.error})}function Gn(n){!n.error&&!n.aborted&&(n.abort(),n.aborted=!0)}class Qn{constructor(e,t,i){this.strategy=e,this.transports=t,this.ttl=i.ttl||1800*1e3,this.usingTLS=i.useTLS,this.timeline=i.timeline}isSupported(){return this.strategy.isSupported()}connect(e,t){var i=this.usingTLS,s=Kn(i),h=s&&s.cacheSkipCount?s.cacheSkipCount:0,b=[this.strategy];if(s&&s.timestamp+this.ttl>=U.now()){var x=this.transports[s.transport];x&&(["ws","wss"].includes(s.transport)||h>3?(this.timeline.info({cached:!0,transport:s.transport,latency:s.latency}),b.push(new be([x],{timeout:s.latency*2+1e3,failFast:!0}))):h++)}var L=U.now(),D=b.pop().connect(e,function H(G,Me){G?(Tt(i),b.length>0?(L=U.now(),D=b.pop().connect(e,H)):t(G)):(Yn(i,Me.transport.name,U.now()-L,h),t(null,Me))});return{abort:function(){D.abort()},forceMinPriority:function(H){e=H,D&&D.forceMinPriority(H)}}}}function it(n){return"pusherTransport"+(n?"TLS":"NonTLS")}function Kn(n){var e=E.getLocalStorage();if(e)try{var t=e[it(n)];if(t)return JSON.parse(t)}catch{Tt(n)}return null}function Yn(n,e,t,i){var s=E.getLocalStorage();if(s)try{s[it(n)]=$e({timestamp:U.now(),transport:e,latency:t,cacheSkipCount:i})}catch{}}function Tt(n){var e=E.getLocalStorage();if(e)try{delete e[it(n)]}catch{}}class ze{constructor(e,{delay:t}){this.strategy=e,this.options={delay:t}}isSupported(){return this.strategy.isSupported()}connect(e,t){var i=this.strategy,s,h=new M(this.options.delay,function(){s=i.connect(e,t)});return{abort:function(){h.ensureAborted(),s&&s.abort()},forceMinPriority:function(b){e=b,s&&s.forceMinPriority(b)}}}}class Pe{constructor(e,t,i){this.test=e,this.trueBranch=t,this.falseBranch=i}isSupported(){var e=this.test()?this.trueBranch:this.falseBranch;return e.isSupported()}connect(e,t){var i=this.test()?this.trueBranch:this.falseBranch;return i.connect(e,t)}}class Zn{constructor(e){this.strategy=e}isSupported(){return this.strategy.isSupported()}connect(e,t){var i=this.strategy.connect(e,function(s,h){h&&i.abort(),t(s,h)});return i}}function je(n){return function(){return n.isSupported()}}var ei=function(n,e,t){var i={};function s(Mt,Yi,Zi,es,ts){var Ut=t(n,Mt,Yi,Zi,es,ts);return i[Mt]=Ut,Ut}var h=Object.assign({},e,{hostNonTLS:n.wsHost+":"+n.wsPort,hostTLS:n.wsHost+":"+n.wssPort,httpPath:n.wsPath}),b=Object.assign({},h,{useTLS:!0}),x=Object.assign({},e,{hostNonTLS:n.httpHost+":"+n.httpPort,hostTLS:n.httpHost+":"+n.httpsPort,httpPath:n.httpPath}),L={loop:!0,timeout:15e3,timeoutLimit:6e4},D=new St({minPingDelay:1e4,maxPingDelay:n.activityTimeout}),H=new St({lives:2,minPingDelay:1e4,maxPingDelay:n.activityTimeout}),G=s("ws","ws",3,h,D),Me=s("wss","ws",3,b,D),Wi=s("sockjs","sockjs",1,x),Et=s("xhr_streaming","xhr_streaming",1,x,H),Vi=s("xdr_streaming","xdr_streaming",1,x,H),Rt=s("xhr_polling","xhr_polling",1,x),Gi=s("xdr_polling","xdr_polling",1,x),$t=new be([G],L),Qi=new be([Me],L),Ki=new be([Wi],L),Nt=new be([new Pe(je(Et),Et,Vi)],L),zt=new be([new Pe(je(Rt),Rt,Gi)],L),Dt=new be([new Pe(je(Nt),new nt([Nt,new ze(zt,{delay:4e3})]),zt)],L),at=new Pe(je(Dt),Dt,Ki),lt;return e.useTLS?lt=new nt([$t,new ze(at,{delay:2e3})]):lt=new nt([$t,new ze(Qi,{delay:2e3}),new ze(at,{delay:5e3})]),new Qn(new Zn(new Pe(je(G),lt,at)),i,{ttl:18e5,timeline:e.timeline,useTLS:e.useTLS})},ti=ei,ni=function(){var n=this;n.timeline.info(n.buildTimelineMessage({transport:n.name+(n.options.useTLS?"s":"")})),n.hooks.isInitialized()?n.changeState("initialized"):n.hooks.file?(n.changeState("initializing"),C.load(n.hooks.file,{useTLS:n.options.useTLS},function(e,t){n.hooks.isInitialized()?(n.changeState("initialized"),t(!0)):(e&&n.onError(e),n.onClose(),t(!1))})):n.onClose()},ii={getRequest:function(n){var e=new window.XDomainRequest;return e.ontimeout=function(){n.emit("error",new k),n.close()},e.onerror=function(t){n.emit("error",t),n.close()},e.onprogress=function(){e.responseText&&e.responseText.length>0&&n.onChunk(200,e.responseText)},e.onload=function(){e.responseText&&e.responseText.length>0&&n.onChunk(200,e.responseText),n.emit("finished",200),n.close()},e},abortRequest:function(n){n.ontimeout=n.onerror=n.onprogress=n.onload=null,n.abort()}},si=ii;const ri=256*1024;class oi extends he{constructor(e,t,i){super(),this.hooks=e,this.method=t,this.url=i}start(e){this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=()=>{this.close()},E.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(e)}close(){this.unloader&&(E.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)}onChunk(e,t){for(;;){var i=this.advanceBuffer(t);if(i)this.emit("chunk",{status:e,data:i});else break}this.isBufferTooLong(t)&&this.emit("buffer_too_long")}advanceBuffer(e){var t=e.slice(this.position),i=t.indexOf(`
`);return i!==-1?(this.position+=i+1,t.slice(0,i)):null}isBufferTooLong(e){return this.position===e.length&&e.length>ri}}var st;(function(n){n[n.CONNECTING=0]="CONNECTING",n[n.OPEN=1]="OPEN",n[n.CLOSED=3]="CLOSED"})(st||(st={}));var _e=st,ai=1;class li{constructor(e,t){this.hooks=e,this.session=jt(1e3)+"/"+di(8),this.location=ci(t),this.readyState=_e.CONNECTING,this.openStream()}send(e){return this.sendRaw(JSON.stringify([e]))}ping(){this.hooks.sendHeartbeat(this)}close(e,t){this.onClose(e,t,!0)}sendRaw(e){if(this.readyState===_e.OPEN)try{return E.createSocketRequest("POST",Pt(ui(this.location,this.session))).start(e),!0}catch{return!1}else return!1}reconnect(){this.closeStream(),this.openStream()}onClose(e,t,i){this.closeStream(),this.readyState=_e.CLOSED,this.onclose&&this.onclose({code:e,reason:t,wasClean:i})}onChunk(e){if(e.status===200){this.readyState===_e.OPEN&&this.onActivity();var t,i=e.data.slice(0,1);switch(i){case"o":t=JSON.parse(e.data.slice(1)||"{}"),this.onOpen(t);break;case"a":t=JSON.parse(e.data.slice(1)||"[]");for(var s=0;s<t.length;s++)this.onEvent(t[s]);break;case"m":t=JSON.parse(e.data.slice(1)||"null"),this.onEvent(t);break;case"h":this.hooks.onHeartbeat(this);break;case"c":t=JSON.parse(e.data.slice(1)||"[]"),this.onClose(t[0],t[1],!0);break}}}onOpen(e){this.readyState===_e.CONNECTING?(e&&e.hostname&&(this.location.base=hi(this.location.base,e.hostname)),this.readyState=_e.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)}onEvent(e){this.readyState===_e.OPEN&&this.onmessage&&this.onmessage({data:e})}onActivity(){this.onactivity&&this.onactivity()}onError(e){this.onerror&&this.onerror(e)}openStream(){this.stream=E.createSocketRequest("POST",Pt(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",e=>{this.onChunk(e)}),this.stream.bind("finished",e=>{this.hooks.onFinished(this,e)}),this.stream.bind("buffer_too_long",()=>{this.reconnect()});try{this.stream.start()}catch(e){U.defer(()=>{this.onError(e),this.onClose(1006,"Could not start streaming",!1)})}}closeStream(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)}}function ci(n){var e=/([^\?]*)\/*(\??.*)/.exec(n);return{base:e[1],queryString:e[2]}}function ui(n,e){return n.base+"/"+e+"/xhr_send"}function Pt(n){var e=n.indexOf("?")===-1?"?":"&";return n+e+"t="+ +new Date+"&n="+ai++}function hi(n,e){var t=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(n);return t[1]+e+t[3]}function jt(n){return E.randomInt(n)}function di(n){for(var e=[],t=0;t<n;t++)e.push(jt(32).toString(32));return e.join("")}var fi=li,pi={getReceiveURL:function(n,e){return n.base+"/"+e+"/xhr_streaming"+n.queryString},onHeartbeat:function(n){n.sendRaw("[]")},sendHeartbeat:function(n){n.sendRaw("[]")},onFinished:function(n,e){n.onClose(1006,"Connection interrupted ("+e+")",!1)}},vi=pi,gi={getReceiveURL:function(n,e){return n.base+"/"+e+"/xhr"+n.queryString},onHeartbeat:function(){},sendHeartbeat:function(n){n.sendRaw("[]")},onFinished:function(n,e){e===200?n.reconnect():n.onClose(1006,"Connection interrupted ("+e+")",!1)}},mi=gi,bi={getRequest:function(n){var e=E.getXHRAPI(),t=new e;return t.onreadystatechange=t.onprogress=function(){switch(t.readyState){case 3:t.responseText&&t.responseText.length>0&&n.onChunk(t.status,t.responseText);break;case 4:t.responseText&&t.responseText.length>0&&n.onChunk(t.status,t.responseText),n.emit("finished",t.status),n.close();break}},t},abortRequest:function(n){n.onreadystatechange=null,n.abort()}},_i=bi,yi={createStreamingSocket(n){return this.createSocket(vi,n)},createPollingSocket(n){return this.createSocket(mi,n)},createSocket(n,e){return new fi(n,e)},createXHR(n,e){return this.createRequest(_i,n,e)},createRequest(n,e,t){return new oi(n,e,t)}},Ot=yi;Ot.createXDR=function(n,e){return this.createRequest(si,n,e)};var wi=Ot,ki={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:c,DependenciesReceivers:y,getDefaultStrategy:ti,Transports:Ln,transportConnectionInitializer:ni,HTTPFactory:wi,TimelineTransport:bn,getXHRAPI(){return window.XMLHttpRequest},getWebSocketAPI(){return window.WebSocket||window.MozWebSocket},setup(n){window.Pusher=n;var e=()=>{this.onDocumentBody(n.ready)};window.JSON?e():C.load("json2",{},e)},getDocument(){return document},getProtocol(){return this.getDocument().location.protocol},getAuthorizers(){return{ajax:oe,jsonp:fn}},onDocumentBody(n){document.body?n():setTimeout(()=>{this.onDocumentBody(n)},0)},createJSONPRequest(n,e){return new vn(n,e)},createScriptRequest(n){return new pn(n)},getLocalStorage(){try{return window.localStorage}catch{return}},createXHR(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest(){var n=this.getXHRAPI();return new n},createMicrosoftXHR(){return new ActiveXObject("Microsoft.XMLHTTP")},getNetwork(){return En},createWebSocket(n){var e=this.getWebSocketAPI();return new e(n)},createSocketRequest(n,e){if(this.isXHRSupported())return this.HTTPFactory.createXHR(n,e);if(this.isXDRSupported(e.indexOf("https:")===0))return this.HTTPFactory.createXDR(n,e);throw"Cross-origin HTTP requests are not supported"},isXHRSupported(){var n=this.getXHRAPI();return!!n&&new n().withCredentials!==void 0},isXDRSupported(n){var e=n?"https:":"http:",t=this.getProtocol();return!!window.XDomainRequest&&t===e},addUnloadListener(n){window.addEventListener!==void 0?window.addEventListener("unload",n,!1):window.attachEvent!==void 0&&window.attachEvent("onunload",n)},removeUnloadListener(n){window.addEventListener!==void 0?window.removeEventListener("unload",n,!1):window.detachEvent!==void 0&&window.detachEvent("onunload",n)},randomInt(n){return Math.floor(function(){return(window.crypto||window.msCrypto).getRandomValues(new Uint32Array(1))[0]/Math.pow(2,32)}()*n)}},E=ki,rt;(function(n){n[n.ERROR=3]="ERROR",n[n.INFO=6]="INFO",n[n.DEBUG=7]="DEBUG"})(rt||(rt={}));var De=rt;class xi{constructor(e,t,i){this.key=e,this.session=t,this.events=[],this.options=i||{},this.sent=0,this.uniqueID=0}log(e,t){e<=this.options.level&&(this.events.push(ee({},t,{timestamp:U.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())}error(e){this.log(De.ERROR,e)}info(e){this.log(De.INFO,e)}debug(e){this.log(De.DEBUG,e)}isEmpty(){return this.events.length===0}send(e,t){var i=ee({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],e(i,(s,h)=>{s||this.sent++,t&&t(s,h)}),!0}generateUniqueID(){return this.uniqueID++,this.uniqueID}}class Ci{constructor(e,t,i,s){this.name=e,this.priority=t,this.transport=i,this.options=s||{}}isSupported(){return this.transport.isSupported({useTLS:this.options.useTLS})}connect(e,t){if(this.isSupported()){if(this.priority<e)return It(new $,t)}else return It(new V,t);var i=!1,s=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),h=null,b=function(){s.unbind("initialized",b),s.connect()},x=function(){h=de.createHandshake(s,function(G){i=!0,H(),t(null,G)})},L=function(G){H(),t(G)},D=function(){H();var G;G=$e(s),t(new J(G))},H=function(){s.unbind("initialized",b),s.unbind("open",x),s.unbind("error",L),s.unbind("closed",D)};return s.bind("initialized",b),s.bind("open",x),s.bind("error",L),s.bind("closed",D),s.initialize(),{abort:()=>{i||(H(),h?h.close():s.close())},forceMinPriority:G=>{i||this.priority<G&&(h?h.close():s.close())}}}}function It(n,e){return U.defer(function(){e(n)}),{abort:function(){},forceMinPriority:function(){}}}const{Transports:Si}=E;var Ti=function(n,e,t,i,s,h){var b=Si[t];if(!b)throw new te(t);var x=(!n.enabledTransports||ft(n.enabledTransports,e)!==-1)&&(!n.disabledTransports||ft(n.disabledTransports,e)===-1),L;return x?(s=Object.assign({ignoreNullOrigin:n.ignoreNullOrigin},s),L=new Ci(e,i,h?h.getAssistant(b):b,s)):L=Pi,L},Pi={isSupported:function(){return!1},connect:function(n,e){var t=U.defer(function(){e(new V)});return{abort:function(){t.ensureAborted()},forceMinPriority:function(){}}}};function ji(n){if(n==null)throw"You must pass an options object";if(n.cluster==null)throw"Options object must provide a cluster";"disableStats"in n&&X.warn("The disableStats option is deprecated in favor of enableStats")}const Oi=(n,e)=>{var t="socket_id="+encodeURIComponent(n.socketId);for(var i in e.params)t+="&"+encodeURIComponent(i)+"="+encodeURIComponent(e.params[i]);if(e.paramsProvider!=null){let s=e.paramsProvider();for(var i in s)t+="&"+encodeURIComponent(i)+"="+encodeURIComponent(s[i])}return t};var Ii=n=>{if(typeof E.getAuthorizers()[n.transport]>"u")throw`'${n.transport}' is not a recognized auth transport`;return(e,t)=>{const i=Oi(e,n);E.getAuthorizers()[n.transport](E,i,n,S.UserAuthentication,t)}};const Li=(n,e)=>{var t="socket_id="+encodeURIComponent(n.socketId);t+="&channel_name="+encodeURIComponent(n.channelName);for(var i in e.params)t+="&"+encodeURIComponent(i)+"="+encodeURIComponent(e.params[i]);if(e.paramsProvider!=null){let s=e.paramsProvider();for(var i in s)t+="&"+encodeURIComponent(i)+"="+encodeURIComponent(s[i])}return t};var Ai=n=>{if(typeof E.getAuthorizers()[n.transport]>"u")throw`'${n.transport}' is not a recognized auth transport`;return(e,t)=>{const i=Li(e,n);E.getAuthorizers()[n.transport](E,i,n,S.ChannelAuthorization,t)}};const Ei=(n,e,t)=>{const i={authTransport:e.transport,authEndpoint:e.endpoint,auth:{params:e.params,headers:e.headers}};return(s,h)=>{const b=n.channel(s.channelName);t(b,i).authorize(s.socketId,h)}};function Lt(n,e){let t={activityTimeout:n.activityTimeout||v.activityTimeout,cluster:n.cluster,httpPath:n.httpPath||v.httpPath,httpPort:n.httpPort||v.httpPort,httpsPort:n.httpsPort||v.httpsPort,pongTimeout:n.pongTimeout||v.pongTimeout,statsHost:n.statsHost||v.stats_host,unavailableTimeout:n.unavailableTimeout||v.unavailableTimeout,wsPath:n.wsPath||v.wsPath,wsPort:n.wsPort||v.wsPort,wssPort:n.wssPort||v.wssPort,enableStats:Di(n),httpHost:Ri(n),useTLS:zi(n),wsHost:$i(n),userAuthenticator:Mi(n),channelAuthorizer:Hi(n,e)};return"disabledTransports"in n&&(t.disabledTransports=n.disabledTransports),"enabledTransports"in n&&(t.enabledTransports=n.enabledTransports),"ignoreNullOrigin"in n&&(t.ignoreNullOrigin=n.ignoreNullOrigin),"timelineParams"in n&&(t.timelineParams=n.timelineParams),"nacl"in n&&(t.nacl=n.nacl),t}function Ri(n){return n.httpHost?n.httpHost:n.cluster?`sockjs-${n.cluster}.pusher.com`:v.httpHost}function $i(n){return n.wsHost?n.wsHost:Ni(n.cluster)}function Ni(n){return`ws-${n}.pusher.com`}function zi(n){return E.getProtocol()==="https:"?!0:n.forceTLS!==!1}function Di(n){return"enableStats"in n?n.enableStats:"disableStats"in n?!n.disableStats:!1}const At=n=>"customHandler"in n&&n.customHandler!=null;function Mi(n){const e=Object.assign(Object.assign({},v.userAuthentication),n.userAuthentication);return At(e)?e.customHandler:Ii(e)}function Ui(n,e){let t;if("channelAuthorization"in n)t=Object.assign(Object.assign({},v.channelAuthorization),n.channelAuthorization);else if(t={transport:n.authTransport||v.authTransport,endpoint:n.authEndpoint||v.authEndpoint},"auth"in n&&("params"in n.auth&&(t.params=n.auth.params),"headers"in n.auth&&(t.headers=n.auth.headers)),"authorizer"in n)return{customHandler:Ei(e,t,n.authorizer)};return t}function Hi(n,e){const t=Ui(n,e);return At(t)?t.customHandler:Ai(t)}class qi extends he{constructor(e){super(function(t,i){X.debug(`No callbacks on watchlist events for ${t}`)}),this.pusher=e,this.bindWatchlistInternalEvent()}handleEvent(e){e.data.events.forEach(t=>{this.emit(t.name,t)})}bindWatchlistInternalEvent(){this.pusher.connection.bind("message",e=>{var t=e.event;t==="pusher_internal:watchlist_events"&&this.handleEvent(e)})}}function Bi(){let n,e;return{promise:new Promise((i,s)=>{n=i,e=s}),resolve:n,reject:e}}var Fi=Bi;class Xi extends he{constructor(e){super(function(t,i){X.debug("No callbacks on user for "+t)}),this.signin_requested=!1,this.user_data=null,this.serverToUserChannel=null,this.signinDonePromise=null,this._signinDoneResolve=null,this._onAuthorize=(t,i)=>{if(t){X.warn(`Error during signin: ${t}`),this._cleanup();return}this.pusher.send_event("pusher:signin",{auth:i.auth,user_data:i.user_data})},this.pusher=e,this.pusher.connection.bind("state_change",({previous:t,current:i})=>{t!=="connected"&&i==="connected"&&this._signin(),t==="connected"&&i!=="connected"&&(this._cleanup(),this._newSigninPromiseIfNeeded())}),this.watchlist=new qi(e),this.pusher.connection.bind("message",t=>{var i=t.event;i==="pusher:signin_success"&&this._onSigninSuccess(t.data),this.serverToUserChannel&&this.serverToUserChannel.name===t.channel&&this.serverToUserChannel.handleEvent(t)})}signin(){this.signin_requested||(this.signin_requested=!0,this._signin())}_signin(){this.signin_requested&&(this._newSigninPromiseIfNeeded(),this.pusher.connection.state==="connected"&&this.pusher.config.userAuthenticator({socketId:this.pusher.connection.socket_id},this._onAuthorize))}_onSigninSuccess(e){try{this.user_data=JSON.parse(e.user_data)}catch{X.error(`Failed parsing user data after signin: ${e.user_data}`),this._cleanup();return}if(typeof this.user_data.id!="string"||this.user_data.id===""){X.error(`user_data doesn't contain an id. user_data: ${this.user_data}`),this._cleanup();return}this._signinDoneResolve(),this._subscribeChannels()}_subscribeChannels(){const e=t=>{t.subscriptionPending&&t.subscriptionCancelled?t.reinstateSubscription():!t.subscriptionPending&&this.pusher.connection.state==="connected"&&t.subscribe()};this.serverToUserChannel=new Ze(`#server-to-user-${this.user_data.id}`,this.pusher),this.serverToUserChannel.bind_global((t,i)=>{t.indexOf("pusher_internal:")===0||t.indexOf("pusher:")===0||this.emit(t,i)}),e(this.serverToUserChannel)}_cleanup(){this.user_data=null,this.serverToUserChannel&&(this.serverToUserChannel.unbind_all(),this.serverToUserChannel.disconnect(),this.serverToUserChannel=null),this.signin_requested&&this._signinDoneResolve()}_newSigninPromiseIfNeeded(){if(!this.signin_requested||this.signinDonePromise&&!this.signinDonePromise.done)return;const{promise:e,resolve:t,reject:i}=Fi();e.done=!1;const s=()=>{e.done=!0};e.then(s).catch(s),this.signinDonePromise=e,this._signinDoneResolve=t}}class K{static ready(){K.isReady=!0;for(var e=0,t=K.instances.length;e<t;e++)K.instances[e].connect()}static getClientFeatures(){return pt(mt({ws:E.Transports.ws},function(e){return e.isSupported({})}))}constructor(e,t){Ji(e),ji(t),this.key=e,this.options=t,this.config=Lt(this.options,this),this.channels=de.createChannels(),this.global_emitter=new he,this.sessionID=E.randomInt(1e9),this.timeline=new xi(this.key,this.sessionID,{cluster:this.config.cluster,features:K.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:De.INFO,version:v.VERSION}),this.config.enableStats&&(this.timelineSender=de.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+E.TimelineTransport.name}));var i=s=>E.getDefaultStrategy(this.config,s,Ti);this.connection=de.createConnectionManager(this.key,{getStrategy:i,timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:!!this.config.useTLS}),this.connection.bind("connected",()=>{this.subscribeAll(),this.timelineSender&&this.timelineSender.send(this.connection.isUsingTLS())}),this.connection.bind("message",s=>{var h=s.event,b=h.indexOf("pusher_internal:")===0;if(s.channel){var x=this.channel(s.channel);x&&x.handleEvent(s)}b||this.global_emitter.emit(s.event,s.data)}),this.connection.bind("connecting",()=>{this.channels.disconnect()}),this.connection.bind("disconnected",()=>{this.channels.disconnect()}),this.connection.bind("error",s=>{X.warn(s)}),K.instances.push(this),this.timeline.info({instances:K.instances.length}),this.user=new Xi(this),K.isReady&&this.connect()}switchCluster(e){const{appKey:t,cluster:i}=e;this.key=t,this.options=Object.assign(Object.assign({},this.options),{cluster:i}),this.config=Lt(this.options,this),this.connection.switchCluster(this.key)}channel(e){return this.channels.find(e)}allChannels(){return this.channels.all()}connect(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var e=this.connection.isUsingTLS(),t=this.timelineSender;this.timelineSenderTimer=new ge(6e4,function(){t.send(e)})}}disconnect(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)}bind(e,t,i){return this.global_emitter.bind(e,t,i),this}unbind(e,t,i){return this.global_emitter.unbind(e,t,i),this}bind_global(e){return this.global_emitter.bind_global(e),this}unbind_global(e){return this.global_emitter.unbind_global(e),this}unbind_all(e){return this.global_emitter.unbind_all(),this}subscribeAll(){var e;for(e in this.channels.channels)this.channels.channels.hasOwnProperty(e)&&this.subscribe(e)}subscribe(e){var t=this.channels.add(e,this);return t.subscriptionPending&&t.subscriptionCancelled?t.reinstateSubscription():!t.subscriptionPending&&this.connection.state==="connected"&&t.subscribe(),t}unsubscribe(e){var t=this.channels.find(e);t&&t.subscriptionPending?t.cancelSubscription():(t=this.channels.remove(e),t&&t.subscribed&&t.unsubscribe())}send_event(e,t,i){return this.connection.send_event(e,t,i)}shouldUseTLS(){return this.config.useTLS}signin(){this.user.signin()}}K.instances=[],K.isReady=!1,K.logToConsole=!1,K.Runtime=E,K.ScriptReceivers=E.ScriptReceivers,K.DependenciesReceivers=E.DependenciesReceivers,K.auth_callbacks=E.auth_callbacks;var ot=a.default=K;function Ji(n){if(n==null)throw"You must pass your app key when you instantiate Pusher."}E.setup(K)}])})})(nn);var _o=nn.exports;const yo=is(_o),wo={class:"px-5 bg-white grid grid-cols-2"},ko={id:"left",class:"basis-1/2"},xo={class:"flex gap-2"},Co={class:"flex items-center justify-between gap-2"},So={class:"w-16 whitespace-nowrap text-xs text-right"},To={class:"badge badge-neutral badge-sm w-10"},Po={class:"flex justify-between p-2"},jo={key:1},Oo={class:"flex items-center gap-2"},Io={key:0,class:"flex items-center gap-2 w-60"},Lo={class:"text-sm whitespace-nowrap"},Ao={class:"flex"},Eo={class:"flex gap-x-4 py-4"},Ro={class:"flex justify-between items-center"},$o={class:"relative inline-flex items-center cursor-pointer p-2"},No={class:"text-sm font-medium text-gray-900 dark:text-gray-300 mr-1"},zo={class:"flex justify-start py-4 gap-x-4 items-center"},Do={class:"w-40 h-40"},Mo={class:"flex flex-col"},Uo={key:0},Ho={class:"flex justify-center p-10"},qo={id:"right",class:"basis-1/2 bg-gray-100 rounded-xl mx-4"},Bo={class:""},Fo={class:"w-full h-screen"},Xo={class:"relative text-sm font-medium cursor-pointer"},Jo={class:"relative"},Wo={class:"flex justify-center pt-52"},Vo={class:"absolute grid z-20 rounded text-accent-content place-content-center"},Go={key:0,class:"grid justify-center justify-items-center rounded-xl bg-neutral w-52 py-8 bg-opacity-80"},Qo=u("span",{class:"loading loading-dots loading-lg text-error"},null,-1),Ko={class:"text-white flex"},Yo={class:"w-16 text-center"},Zo={class:"absolute inset-0"},ea={key:0,class:""},ta={class:"flex justify-center"},na=["src"],ia={class:"flex justify-center py-5"},sa=u("progress",{class:"progress w-56"},null,-1),ra=[sa],oa={key:1,class:"text-2xl text-stone-700 text-center z-30 pt-20"},aa={id:"my_modal_3",class:"modal bg-gray-900 bg-opacity-80"},la={class:"h-max w-max"},ca=u("form",{method:"dialog"},[u("button",{class:"btn btn-circle btn-ghost absolute right-2 top-2 text-2xl bg-gray-500 hover:bg-white"},"✕")],-1),ua={class:"flex items-center gap-x-9 w-screen justify-evenly"},ha={class:"text-white pb-20"},da=u("svg",{class:"w-6 h-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})],-1),fa=[da],pa=["src"],va={class:"text-white pb-20"},ga=u("svg",{class:"w-6 h-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})],-1),ma=[ga],ja={__name:"ImageIndex",props:["sdratio","omratio","token","omSamplers","lcSamplers","sdSamplers","engines"],setup(p){window.Pusher=yo;const d=Kt(),r=p,a=q(!1),o=q(!1),l=q(!1),c=q(),m=q(),v=q(!1),w=q(null),y=q([]),C=q({buttonGroups:[],id:null}),T=q(1),R=q("Unknown"),N=q(""),S=q([]),f=q(0),_=q(null);var k=[],$=3e3,J=1,Q="";let te=localStorage.getItem("aibox_params"),V={};te!=null?(V=JSON.parse(te),V.niji!=null&&(o.value=!0),V.model_hash_id=null,V.lora_hash_id=null,V.image_num=V.image_num??1,V.lora_scale=V.lora_scale??.9):V={engine:"lc",model_hash_id:null,lora_hash_id:null,model_name:null,lora_name:null,prompt:null,prompt_en:null,negative_prompt:null,negative_prompt_en:null,asp_id:0,niji:null,steps:null,cfg_scale:null,seed:0,face_enhance:!1,upscale:null,width:null,height:null,weird:null,denoising_strength:null,cref:null,sref:null,sampler_name:null,isRandom:!0,image_num:1,lora_scale:.9};const g=Fe(V);ss(()=>{oe(T.value),S.value=re(g.engine),g.sampler_name=S.value.length>0?S.value[0].val:null,window.Echo=new bo({broadcaster:"reverb",key:"4vfwamrpeeeex75poslv",wsHost:d.props.reverbHost,wsPort:"8080",wssPort:"8080",forceTLS:!1,enabledTransports:["ws","wss"]})});function re(j){switch(j){case"lc":case"atz":return r.lcSamplers;case"sd":return r.sdSamplers;default:return[]}}async function oe(j){if(k.includes(j)){console.log(j,"requested this page");return}k.push(j);let I=await ct("get","/api/images",{page:j});if(I!=null&&I.code==1){let M=I.data;M!==null&&M.forEach(ge=>{y.value.push(ge)}),M.length>0&&(T.value=j)}}function F(j,I){switch(j){case"isAdvance":a.value=I;break;case"isNiji":o.value=I;break;case"engine":Ae(I.engine);break;case"style":ke(I);break;case"init_img_path":w.value=I;break;case"work_image":ve(I);break;case"model_name":g.model_hash_id=I.hash??null,fe.styleList=JSON.parse(I.tags??"[]"),g.model_name=I.sd_name,["sdxl","presdxl"].includes(I.base_model)?_.value="sdxl":_.value="1.5";break;case"lora_name":g.lora_hash_id=I.hash??null,g.lora_name=I.sd_name??null;break;case"sampler_name":g[j]=I.val;break;case"asp_id":g.asp_id=I;let M=c.value[I];g.width=parseInt(M.width*J),g.height=parseInt(M.height*J);break;case"prompt":g[j]=I,g.prompt_en=null;break;default:g[j]=I}}function ve(j){if(C.value=j,C.value.index>=y.value.length-3&&oe(T.value+1),j.task!=null){let I=j.task;Object.entries(g).forEach(function([M,ge]){M in I&&(g[M]=I[M])})}}function ke(j){let I=j;g.prompt.indexOf(I)!==-1||(g.prompt=g.prompt+","+I)}function Ae(j){switch(g.engine=j,g.model_name=null,g.lora_name=null,g.model_hash_id=null,g.lora_hash_id=null,S.value=re(g.engine),g.sampler_name=S.value.length>0?S.value[0].val:null,j){case"mj":l.value=!0,c.value=r.omratio,m.value=fe.mjConfig,g.image_num=1;break;case"sd":g.image_num=1;case"atz":case"lc":l.value=!1,c.value=r.sdratio,m.value=fe.sdConfig;break;default:g.image_num=1,l.value=!1,c.value=r.sdratio,m.value=fe.sdConfig}g.cfg_scale=m.value.cfg_scale.def,g.steps=m.value.steps.def,g.seed=m.value.seed.def,g.weird=m.value.weird.def,g.denoising_strength=m.value.denoising_strength.def}Ae(g.engine),F("asp_id",g.asp_id??0);async function Je(){if(window.Echo.leave("private-channel_task."+Q),f.value=0,v.value)return;let j="MK",I=ls(j,g);if(I!==!0){Oe(I,"error");return}localStorage.setItem("aibox_params",JSON.stringify(g));let M=cs(g);M.append("act",j),M.append("job_type","MK");var ge={};M.forEach((ee,Ge)=>ge[Ge]=ee),console.log(JSON.stringify(ge)),w.value!=null&&M.append("init_img_path",w.value),v.value=!0;let Ve=r.token,U=await ct("post","/api/task",M,{"Content-Type":"multipart/form-data",Authorization:Ve});U!=null&&U.code==1?($=parseInt(U.execTime)*100,Se(),Q=U.data.task_id,g.prompt_en=U.data.prompt_en,g.negative_prompt_en=U.data.negative_prompt_en,Re(U.data.task_id),f.value=U.data.image_num,U.data!=null&&U.data.init_img!=null&&U.data.init_img!=""&&(w.value=U.data.init_img)):(v.value=!1,Oe(U.msg??O("Failed to submit AI generation task"),"error"))}function Se(j){$<=-6e3?(v.value==!0&&(v.value=!1,Oe(O("Over time"),"info")),console.log("over time 60d"),R.value="Unknown"):($--,R.value=$/100+"秒",setTimeout(function(){Se()},10))}async function We(j){if(console.log(j),v.value==!0){console.log("Task is running");return}v.value=!0,j.act=="EDIT"?rs.get(route("tools.cropper",{url:j.img.show_url})):($=1500,Se(),f.value=1,us(j.act,{init_img_path:j.img.show_url,id:j.img.id,engine:g.engine},Ee))}function Ee(j){console.log("ws call back",j,f.value),j.message_type=="standing"?(y.value.unshift(j),C.value=j,$=3e3,f.value=f.value-1,f.value==0&&(v.value=!1)):j.message_type=="ephemeral"?(v.value=!0,$=parseInt(j.execTime??"1")*100):j.message_type=="failed"&&(v.value=!1,$=3e3,Oe(j.msg??O("Failed to submit AI generation task"),"error"))}const Re=j=>{console.log("listen: channel_task =",j),window.Echo.private("channel_task."+j).listen("TaskMessage",async I=>{Ee(I.message)})};return(j,I)=>(P(),Ce(os,{title:"AI images"},{header:qt(()=>[W(hs,{init:r.engines,def:g.engine,name:"engine",onTsComCallback:F},null,8,["init","def"])]),default:qt(()=>[W(Kr),u("div",wo,[u("div",ko,[u("div",xo,[["lc","atz"].includes(g.engine)?(P(),Ce(Xt,{key:0,name:"model_name",label:z(O)("model"),engine:g.engine,init:"checkpoint",onTsComCallback:F,def:g.model_name},null,8,["label","engine","def"])):pe("",!0),u("div",null,[["lc","atz","sd"].includes(g.engine)?(P(),Ce(Xt,{key:0,name:"lora_name",label:z(O)("lora"),engine:g.engine,init:"lora",onTsComCallback:F,base:_.value,def:g.lora_name},null,8,["label","engine","base","def"])):pe("",!0),ne(u("div",Co,[ne(u("input",{type:"range",min:"0",max:"1",step:"0.1","onUpdate:modelValue":I[0]||(I[0]=M=>g.lora_scale=M),class:"range range-xs range-success"},null,512),[[Bt,g.lora_scale]]),u("label",So,B(z(O)("scale"))+":",1),u("div",To,B(g.lora_scale),1)],512),[[ae,g.lora_hash_id!=null&&["lc","atz"].includes(g.engine)]])])]),u("div",null,[W(Jt,{name:"prompt",label:z(O)("prompt"),onTsComCallback:F,def:g.prompt},null,8,["label","def"]),z(fe).styleList.length>0?(P(),Ce(Xr,{key:0,name:"style",init:z(fe).styleList,onTsComCallback:F},null,8,["init"])):pe("",!0)]),W(_r,{name:"asp_id",label:"Aspect",onTsComCallback:F,init:c.value,def:g.asp_id},null,8,["init","def"]),u("div",Po,[l.value?(P(),Ce(Ue,{key:0,name:"isNiji",label:"Niji?",onTsComCallback:F,def:o.value},null,8,["def"])):(P(),A("div",jo)),u("div",Oo,[["lc","atz"].includes(g.engine)?(P(),A("div",Io,[u("div",Lo,B(z(O)("image num"))+":"+B(g.image_num),1),ne(u("input",{type:"range",min:"1",max:"20",value:"1","onUpdate:modelValue":I[1]||(I[1]=M=>g.image_num=M),class:"range range-success range-sm"},null,512),[[Bt,g.image_num]])])):pe("",!0),W(Ue,{name:"isRandom",label:z(O)("random seed"),onTsComCallback:F,def:g.isRandom},null,8,["label","def"]),W(Ue,{name:"isAdvance",label:z(O)("advance"),onTsComCallback:F,def:a.value},null,8,["label","def"])])]),ne(u("div",Ao,[W(Wt,{init:z(fe).nijiStyle,def:g.niji,name:"niji",onTsComCallback:F},null,8,["init","def"])],512),[[ae,o.value&&l.value]]),ne(u("div",{class:"divider"},B(z(O)("advance")),513),[[ae,a.value]]),ne(u("div",null,[W(Jt,{name:"negative_prompt",label:z(O)("neg prompt"),onTsComCallback:F,def:g.negative_prompt},null,8,["label","def"]),u("div",Eo,[u("div",null,[W(ye,{name:"steps",label:z(O)("steps"),onTsComCallback:F,min:m.value.steps.min.toString,max:m.value.steps.max,def:g.steps,step:m.value.steps.step},null,8,["label","min","max","def","step"])]),u("div",null,[W(ye,{name:"cfg_scale",label:z(O)("scale"),onTsComCallback:F,min:m.value.cfg_scale.min,max:m.value.cfg_scale.max,def:g.cfg_scale},null,8,["label","min","max","def"])]),u("div",null,[ne(W(ye,{name:"seed",label:z(O)("seed"),onTsComCallback:F,min:m.value.seed.min,max:m.value.seed.max,def:g.seed},null,8,["label","min","max","def"]),[[ae,!g.isRandom]])]),u("div",null,[ne(W(ye,{name:"weird",label:"Weird",onTsComCallback:F,min:m.value.weird.min,max:m.value.weird.max,def:g.weird},null,8,["min","max","def"]),[[ae,g.engine=="mj"]])])]),ne(u("div",Ro,[W(Ue,{name:"face_enhance",label:z(O)("Face enhance"),onTsComCallback:F,def:g.face_enhance},null,8,["label","def"]),u("label",$o,[u("span",No,B(z(O)("upscale")),1),W(Wt,{init:z(fe).upscaleOptions,def:g.upscale,name:"upscale",onTsComCallback:F},null,8,["init","def"])])],512),[[ae,["lc","atz"].includes(g.engine)]]),g.engine!="mj"?(P(),Ce(Ps,{key:0,name:"sampler_name",label:z(O)("sampler"),init:S.value,onTsComCallback:F,def:g.sampler_name},null,8,["label","init","def"])):pe("",!0),u("div",zo,[u("div",Do,[W(Or,{name:"init_img_path",desc:z(O)("upload a picture"),def:w.value,onTsComCallback:F},null,8,["desc","def"])]),ne(u("div",Mo,[W(ye,{name:"denoising_strength",label:"Denoising",onTsComCallback:F,min:m.value.denoising_strength.min,max:m.value.denoising_strength.max,def:g.denoising_strength,step:m.value.denoising_strength.step},null,8,["min","max","def","step"]),g.engine=="mj"&&m.value.cref!=null?(P(),A("div",Uo,[W(ye,{name:"cref",label:z(O)("cref"),onTsComCallback:F,min:m.value.cref.min,max:m.value.cref.max,def:g.cref,step:m.value.cref.step},null,8,["label","min","max","def","step"]),W(ye,{name:"sref",label:z(O)("sref"),onTsComCallback:F,min:m.value.sref.min,max:m.value.sref.max,def:g.sref,step:m.value.sref.step},null,8,["label","min","max","def","step"])])):pe("",!0)],512),[[ae,w.value!=null]])])],512),[[ae,a.value]]),u("div",Ho,[u("button",{onClick:Je,type:"button",class:"text-white bg-gradient-to-r from-green-500 via-green-600 to-green-700 hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-green-300 shadow-lg shadow-green-500/50 font-medium rounded-full w-32 text-sm px-5 py-2.5 text-center me-2 mb-2"},B(j.$t("Generate")),1)])]),u("div",qo,[u("div",Bo,[W(qr,{name:"work_image",init:y.value,def:0,tabstyle:"small",onTsComCallback:F,moveto:N.value},null,8,["init","moveto"])]),u("div",Fo,[u("div",Xo,[u("div",Jo,[u("div",Wo,[u("div",Vo,[v.value?(P(),A("div",Go,[Qo,u("label",Ko,[Yt(" No."+B(f.value)+" "+B(z(O)("estimated"))+":",1),u("div",Yo,B(R.value),1)])])):pe("",!0)])]),u("div",Zo,[C.value.show_url!=null?(P(),A("div",ea,[u("div",ta,[u("img",{onclick:"my_modal_3.showModal()",src:C.value.show_url},null,8,na)]),ne(u("div",ia,ra,512),[[ae,v.value]]),W(no,{init:C.value.buttonGroups,name:"show_image",img:C.value,onBtnAction:We},null,8,["init","img"])])):(P(),A("div",oa,B(z(O)("image preview area")),1))])])])])]),u("dialog",aa,[u("div",la,[ca,u("div",ua,[u("div",ha,[u("button",{onClick:I[2]||(I[2]=M=>N.value="pre_"+C.value.index),class:"btn btn-circle btn-ghost right-2 top-2 text-2xl bg-gray-500 hover:bg-white bg-opacity-55 hover:text-black"},fa)]),u("img",{class:"h-screen",src:C.value.show_url},null,8,pa),u("div",va,[u("button",{onClick:I[3]||(I[3]=M=>N.value="next_"+C.value.index),class:"btn btn-circle btn-ghost right-2 top-2 text-2xl bg-gray-500 hover:bg-white bg-opacity-55 hover:text-black"},ma)])])])])])]),_:1}))}};export{ja as default};

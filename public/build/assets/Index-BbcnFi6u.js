import{p as w,Q as $,o as n,c as A,w as D,a as o,d as l,g as m,n as k,t as d,F as h,u as f,q as r,k as E,s as j,f as P,e as R}from"./app-BTzmeDWY.js";import{_ as S}from"./AppLayout-CQqgKRis.js";import{a as y,s as b}from"./network-ChbNVeWA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TopSnackbar-Czlq5nYM.js";const T={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 py-2"},q={class:"grid"},G={role:"tablist",class:"tabs tabs-boxed tabls-sm justify-self-start min-w-96"},L=["onClick"],z={key:0,class:"grid grid-cols-2"},F={class:"collapse-title text-xl font-medium flex justify-between"},M={class:"flex gap-1 items-center"},W=["onClick"],H=["onClick"],J=["onClick"],Q={class:"p-2"},X={class:"join join-vertical lg:join-horizontal py-1 items-center w-full"},Y={class:"btn join-item w-28 bg-base-300 mr-1"},Z={key:0},K={key:0,class:"badge badge-success text-white font-bold h-8"},tt={key:1,class:"badge badge-neutral"},et={key:1,class:"text-sm p-1"},st={key:2,class:"text-sm p-1"},ot=["href"],at=["name","onUpdate:modelValue"],it=o("hr",null,null,-1),nt={key:0,class:"form-control"},lt={class:"label"},ct={class:"label-text"},rt=o("span",{class:"label-text-alt"},"config/mk_config.ini",-1),dt={class:"label"},_t={class:"label-text-alt"},ft={key:1},gt={class:"stat text-sm font-semibold text-red-500"},vt={__name:"Index",props:["ai_config","config_options","clientConfig"],setup(V){const p=V,u=w(p.ai_config),v=$();console.log(v.props.auth.user.is_admin);const t=w({configOption:"engine"});Object.entries(u).forEach(([a,_])=>{Object.entries(_).forEach(([s,e])=>{Object.entries(e).forEach(([i,c])=>{if(i!="label"){let g=a+"."+s+"."+i;t[g]=c}})})});function B(a){t.configOption=a}async function I(a,_){console.log(a,_,t);let s={pkey:a,skey:_,config:JSON.stringify(t)},e=await y("post","/api/config/update",s);if(console.log(e),e!=null&&e.code==1)b(r("Operation successfully"),"success");else{b(e.msg??r("Operation failed"),"error");return}}async function x(a,_){let s=a+"."+_+".is_active";if(t[s]=t[s]==1?0:1,a=="storage")if(t[s]==1)Object.entries(u[a]).forEach(([c,g])=>{console.log(g),u[a][c].is_active=0;let O=a+"."+c+".is_active";t[O]=0}),t[s]=1;else{let c=!1;if(Object.entries(u[a]).forEach(([g,O])=>{let C=a+"."+g+".is_active";if(console.log(t[C]),t[C]==1){c=!0;return}}),!c){b(r("At least one active storage is required"),"info"),t[s]=1;return}}let e={c_key:s,c_value:t[s]},i=await y("post","/api/config/active",e);if(i!=null&&i.code==1)u[a][_].is_active=t[s];else{b(i.msg??r("Operation failed"),"error");return}console.log(i)}function N(){var a=document.createElement("canvas"),_=a.getContext("webgl")||a.getContext("experimental-webgl"),s=_.getExtension("WEBGL_debug_renderer_info"),e=s?_.getParameter(s.UNMASKED_RENDERER_WEBGL):"Unavailable";return e}var U=N();return console.log(U),(a,_)=>(n(),A(S,{title:"Config Panel"},{default:D(()=>[o("div",T,[o("div",q,[o("div",G,[(n(!0),l(h,null,m(p.config_options,(s,e)=>(n(),l("a",{key:e,class:k([{"tab-active":s.option==t.configOption},"tab"]),onClick:i=>B(s.option),role:"tab"},d(s.label),11,L))),128))])]),f(v).props.auth.user.is_admin==1?(n(),l("div",z,[(n(!0),l(h,null,m(u[t.configOption],(s,e)=>(n(),l("div",{key:"e_"+e,class:"m-2"},[o("div",{class:k(["rounded-xl h-full",s.is_active==1?"bg-base-200 border border-green-600":"bg-base-200"])},[o("div",F,[o("div",null,d(f(r)(e)),1),o("div",M,[s.is_active==0?(n(),l("button",{key:0,class:"btn btn-primary btn-sm",onClick:i=>x(t.configOption,e)},d(f(r)("active")),9,W)):(n(),l("button",{key:1,class:"btn btn-neutral btn-sm",onClick:i=>x(t.configOption,e)},d(f(r)("disable")),9,H)),o("button",{class:"btn btn-primary btn-sm",onClick:i=>I(t.configOption,e)},d(f(r)("save")),9,J)])]),o("div",Q,[(n(!0),l(h,null,m(s,(i,c)=>(n(),l("div",{key:e+c},[o("div",X,[o("label",Y,d(f(r)(c)),1),c=="is_active"?(n(),l("div",Z,[i=="1"?(n(),l("div",K,d(f(r)("actived")),1)):(n(),l("div",tt,d(f(r)("disabled")),1))])):c=="label"?(n(),l("label",et,d(f(r)(i)),1)):c=="apply_url"?(n(),l("label",st,[o("a",{href:i,target:"_blank"},d(i),9,ot)])):E((n(),l("input",{key:3,type:"text",placeholder:"Type here",name:t.configOption+"."+e+"."+c,class:"join-item input input-bordered w-full max-w-xs","onUpdate:modelValue":g=>t[t.configOption+"."+e+"."+c]=g},null,8,at)),[[j,t[t.configOption+"."+e+"."+c]]])])]))),128)),it,t.configOption=="engine"&&e=="lc"?(n(),l("label",nt,[o("div",lt,[o("span",ct,d(f(r)("Image generator config file")),1),rt]),E(o("textarea",{class:"textarea textarea-bordered h-24",placeholder:"","onUpdate:modelValue":_[0]||(_[0]=i=>p.clientConfig=i)},`
                            `,512),[[j,p.clientConfig]]),o("div",dt,[o("span",_t,d(f(r)("Paste this content into the file:config/mk_config.ini")),1),P(" "+d(e),1)])])):R("",!0)])],2)]))),128))])):(n(),l("div",ft,[o("p",gt,d(f(r)("Only administrators can manage configuration")),1)]))])]),_:1}))}};export{vt as default};

import{p as C,Q as I,o as n,c as $,w as A,a as o,d as l,g as m,n as w,t as d,F as h,u as f,q as r,k,s as E,f as D,e as P}from"./app-BWrTxLgR.js";import{_ as R}from"./AppLayout-CxeoUJzj.js";import{a as j,s as p}from"./network-CC0hEWry.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TopSnackbar-GxIwM5ci.js";const S={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 py-2"},T={class:"grid"},q={role:"tablist",class:"tabs tabs-boxed tabls-sm justify-self-start min-w-96"},G=["onClick"],L={key:0,class:"grid grid-cols-2"},z={class:"collapse-title text-xl font-medium flex justify-between"},F={class:"flex gap-1 items-center"},M=["onClick"],W=["onClick"],H=["onClick"],J={class:"p-2"},Q={class:"join join-vertical lg:join-horizontal py-1 items-center w-full"},X={class:"btn join-item w-28 bg-base-300 mr-1"},Y={key:0},Z={key:0,class:"badge badge-success text-white font-bold h-8"},K={key:1,class:"badge badge-neutral"},tt={key:1,class:"text-sm p-1"},et={key:2,class:"text-sm p-1"},st=["href"],ot=["name","onUpdate:modelValue"],at=o("hr",null,null,-1),it={key:0,class:"form-control"},nt={class:"label"},lt={class:"label-text"},ct=o("span",{class:"label-text-alt"},"config/mk_config.ini",-1),rt={class:"label"},dt={class:"label-text-alt"},_t={key:1},ft={class:"stat text-sm font-semibold text-red-500"},ht={__name:"Index",props:["ai_config","config_options","clientConfig"],setup(y){const u=y,b=C(u.ai_config),V=I(),t=C({configOption:"engine"});Object.entries(b).forEach(([a,_])=>{Object.entries(_).forEach(([s,e])=>{Object.entries(e).forEach(([i,c])=>{if(i!="label"){let g=a+"."+s+"."+i;t[g]=c}})})});function B(a){t.configOption=a}async function N(a,_){console.log(a,_,t);let s={pkey:a,skey:_,config:JSON.stringify(t)},e=await j("post","/api/config/update",s);if(console.log(e),e!=null&&e.code==1)p(r("Operation successfully"),"success");else{p(e.msg??r("Operation failed"),"error");return}}async function v(a,_){let s=a+"."+_+".is_active";if(t[s]=t[s]==1?0:1,a=="storage")if(t[s]==1)Object.entries(b[a]).forEach(([c,g])=>{console.log(g),b[a][c].is_active=0;let x=a+"."+c+".is_active";t[x]=0}),t[s]=1;else{let c=!1;if(Object.entries(b[a]).forEach(([g,x])=>{let O=a+"."+g+".is_active";if(console.log(t[O]),t[O]==1){c=!0;return}}),!c){p(r("At least one active storage is required"),"info"),t[s]=1;return}}let e={c_key:s,c_value:t[s]},i=await j("post","/api/config/active",e);if(i!=null&&i.code==1)b[a][_].is_active=t[s];else{p(i.msg??r("Operation failed"),"error");return}console.log(i)}function U(){var a=document.createElement("canvas"),_=a.getContext("webgl")||a.getContext("experimental-webgl"),s=_.getExtension("WEBGL_debug_renderer_info"),e=s?_.getParameter(s.UNMASKED_RENDERER_WEBGL):"Unavailable";return e}return U(),(a,_)=>(n(),$(R,{title:"Config Panel"},{default:A(()=>[o("div",S,[o("div",T,[o("div",q,[(n(!0),l(h,null,m(u.config_options,(s,e)=>(n(),l("a",{key:e,class:w([{"tab-active":s.option==t.configOption},"tab"]),onClick:i=>B(s.option),role:"tab"},d(s.label),11,G))),128))])]),f(V).props.auth.user.is_admin==1?(n(),l("div",L,[(n(!0),l(h,null,m(b[t.configOption],(s,e)=>(n(),l("div",{key:"e_"+e,class:"m-2"},[o("div",{class:w(["rounded-xl h-full",s.is_active==1?"bg-base-200 border border-green-600":"bg-base-200"])},[o("div",z,[o("div",null,d(f(r)(e)),1),o("div",F,[s.is_active==0?(n(),l("button",{key:0,class:"btn btn-primary btn-sm",onClick:i=>v(t.configOption,e)},d(f(r)("active")),9,M)):(n(),l("button",{key:1,class:"btn btn-neutral btn-sm",onClick:i=>v(t.configOption,e)},d(f(r)("disable")),9,W)),o("button",{class:"btn btn-primary btn-sm",onClick:i=>N(t.configOption,e)},d(f(r)("save")),9,H)])]),o("div",J,[(n(!0),l(h,null,m(s,(i,c)=>(n(),l("div",{key:e+c},[o("div",Q,[o("label",X,d(f(r)(c)),1),c=="is_active"?(n(),l("div",Y,[i=="1"?(n(),l("div",Z,d(f(r)("actived")),1)):(n(),l("div",K,d(f(r)("disabled")),1))])):c=="label"?(n(),l("label",tt,d(f(r)(i)),1)):c=="apply_url"?(n(),l("label",et,[o("a",{href:i,target:"_blank"},d(i),9,st)])):k((n(),l("input",{key:3,type:"text",placeholder:"Type here",name:t.configOption+"."+e+"."+c,class:"join-item input input-bordered w-full max-w-xs","onUpdate:modelValue":g=>t[t.configOption+"."+e+"."+c]=g},null,8,ot)),[[E,t[t.configOption+"."+e+"."+c]]])])]))),128)),at,t.configOption=="engine"&&e=="lc"?(n(),l("label",it,[o("div",nt,[o("span",lt,d(f(r)("Image generator config file")),1),ct]),k(o("textarea",{class:"textarea textarea-bordered h-24",placeholder:"","onUpdate:modelValue":_[0]||(_[0]=i=>u.clientConfig=i)},`
                            `,512),[[E,u.clientConfig]]),o("div",rt,[o("span",dt,d(f(r)("Paste this content into the file:config/mk_config.ini")),1),D(" "+d(e),1)])])):P("",!0)])],2)]))),128))])):(n(),l("div",_t,[o("p",ft,d(f(r)("Only administrators can manage configuration")),1)]))])]),_:1}))}};export{ht as default};
